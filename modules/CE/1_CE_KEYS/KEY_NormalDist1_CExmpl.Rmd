---
title: "Annotated Key"
subtitle: "Normal Distributions Class Example"
author: Derek H. Ogle
layout: page
css: "/css/modules.css"
output:
  html_document:
    fig_height: 3.5
    fig_width: 3.5
    self_contained: false
---

```{r echo=FALSE, eval=FALSE}
## Renders an appropriate HTML file and moves to CE directory
source("1_CE_Keys/zzz_modHTML_CEKeys.R")
modHTML_CEKeys("KEY_NormalDist1_CExmpl")
```
```{r echo=FALSE, results='hide', message=FALSE, warning=FALSE}
library(NCStats)
source("../../../rhelpers/knitr_setup.R")
```

```{r echo=FALSE, results="hide"}
library(NCStats)
library(ggplot2)

library(ggplot2)
library(NCStats)

mn <- 450
sd <- 50
brks <- mn+seq(-3,3,by=1)*sd

b <- ggplot(data.frame(x=c(-Inf,Inf)),mapping=aes(x=x)) +
  stat_function(fun=dnorm,args=list(mean=mn,sd=sd),xlim=c(mn-4*sd,mn+4*sd),
                geom="line",color="black",size=1.1) +
  scale_y_continuous(expand=expansion(mult=c(0,0.04))) +
  scale_x_continuous(breaks=brks,expand=expansion(mult=c(0,0))) +
  labs(x="Weight (g)") +
  theme_NCStats() +
  theme(axis.title.y=element_blank(),axis.title.x=element_text(size=16),
        axis.text.x=element_text(size=12),axis.text.y=element_blank())
```

## Wood Duck Weights
<ol>
  <li>The percentage of wood ducks that weight between 350 and 550 g is 95%.</li>
</ol>

<div class="alert alert-warning">
<p>This follows directly from the middle part of the 68-95-99.7% Rule because 350 is exactly 2&sigma; below &mu; and 550 is exactly 2&sigma; above &mu;.</p>

```{r echo=FALSE}
b +
  stat_function(fun=dnorm,args=list(mean=mn,sd=sd),xlim=c(mn-2*sd,mn+2*sd),
                geom="area",fill="red",color="black",size=1.1) +
  ggpmisc::geom_text_npc(aes(npcx=0.5,npcy=0.05,label="95%"),
                         size=7,color="white")
```
</div>

&nbsp;

<ol start="2">
  <li>The percentage of wood ducks that weight more than 550 g is 2.5%.</li>
</ol>

<div class="alert alert-warning">
<p> We see that 550 is exactly 2&sigma; above &mu;. Thus, there is 95% between 350 (2&sigma; below &mu;) and 550, 5% outside of that range, and 2.5% in each tail outside of that range. Thus, 2.5% are greater than 550.</p>

```{r echo=FALSE}
b + 
  stat_function(fun=dnorm,args=list(mean=mn,sd=sd),xlim=c(mn-2*sd,mn+2*sd),
                geom="area",fill="gray40",color="black",size=1.1) +
  ggpmisc::geom_text_npc(aes(npcx=0.5,npcy=0.05,label="95%"),
                         size=7,color="white") +
  stat_function(fun=dnorm,args=list(mean=mn,sd=sd),xlim=c(mn-4*sd,mn-2*sd),
                geom="area",fill="red",alpha=0.3,color="black",size=1.1) +
  ggpmisc::geom_text_npc(aes(npcx=0.03,npcy=0.1,label="2.5%"),
                         size=7,color="black",hjust=0) +
  stat_function(fun=dnorm,args=list(mean=mn,sd=sd),xlim=c(mn+2*sd,mn+4*sd),
                geom="area",fill="red",color="black",size=1.1) +
  ggpmisc::geom_text_npc(aes(npcx=0.97,npcy=0.1,label="2.5%"),
                         size=7,color="black",hjust=1)
```
</div>

&nbsp;

<ol start="3">
  <li>The percentage of wood ducks that weigh less than 400 g is 16%</li>
</ol>

<div class="alert alert-warning">
<p> We see that 400 is exactly 1&sigma; below &mu;. Thus, there is 68% between 400 and 500 (1&sigma; above &mu;), 32% outside of that range, and 16% in each tail outside of that range. Thus, 16% are less than 400.</p>

```{r echo=FALSE}
b + 
  stat_function(fun=dnorm,args=list(mean=mn,sd=sd),xlim=c(mn-1*sd,mn+1*sd),
                geom="area",fill="gray40",color="black",size=1.1) +
  ggpmisc::geom_text_npc(aes(npcx=0.5,npcy=0.05,label="68%"),
                         size=7,color="white") +
  stat_function(fun=dnorm,args=list(mean=mn,sd=sd),xlim=c(mn-4*sd,mn-1*sd),
                geom="area",fill="red",color="black",size=1.1) +
  ggpmisc::geom_text_npc(aes(npcx=0.1,npcy=0.2,label="16%"),
                         size=7,color="black",hjust=0) +
  stat_function(fun=dnorm,args=list(mean=mn,sd=sd),xlim=c(mn+1*sd,mn+4*sd),
                geom="area",fill="red",alpha=0.3,color="black",size=1.1) +
  ggpmisc::geom_text_npc(aes(npcx=0.9,npcy=0.2,label="16%"),
                         size=7,color="black",hjust=1)
```
</div>

&nbsp;

<ol start="4">
  <li>The percentage of wood ducks that weigh less than 500 g is 84%</li>
</ol>

<div class="alert alert-warning">
<p>Referring to the plot in the previous question, we see that 500 is exactly 1&sigma; above &mu;, there is 68% between 400 and 500, and 16% in each tail outside of that range. Thus, the percentage less than 500 g is the 68% between 400 and 500 g plus the 16% that is less than 400 g; for a total of 84%.</p>
</div>
&nbsp;

<ol start="5">
  <li>The percentage of wood ducks that weigh between 350 and 500 g is 81.5%</li>
</ol>

<div class="alert alert-warning">
<p>From the previous question we know that 84% of wood ducks weigh less than 500 g. However, this 84% contains wood ducks that weigh less than 350 g, which we do not want considered in this question. From question 2, we know that 2.5% of wood ducks weigh less than 350 g. Thus, 84-2.5=81.5% of wood ducks weigh less than 500 g, but not less than 350 g (or weigh between 350 and 500 g).</p>
</div>
&nbsp;

<ol start="6">
  <li>The most common 68% of wood ducks weigh between 400 and 500 g.</li>
</ol>

<div class="alert alert-warning">
<p>Most common means starting in the middle of the normal distribution and radiating to the tails. This question ends on the first part of the 68-95-99.7% Rule and, thus, 68% of the wood ducks are between 1&sigma; below &mu; (=400) and 1&sigma; above &mu; (=500).</p>
<div>

&nbsp;

<ol start="7">
  <li>The lightest (smallest) 16% of wood ducks weigh less than 400 g.</li>
</ol>

<div class="alert alert-warning">
<p>This percentage should sound familiar from the previous questions. With that experience you know that 16% is in the tails outside of the 68% range. This questions asks for the lightest wood ducks so it would be to left (or lower) tail of the normal distribution. Thus, the lightest 16% of wood ducks are less than 1&sigma; below &mu; (=400).</p>

```{r echo=FALSE}
b + 
  stat_function(fun=dnorm,args=list(mean=mn,sd=sd),xlim=c(mn-1*sd,mn+1*sd),
                geom="area",fill="gray40",color="black",size=1.1) +
  ggpmisc::geom_text_npc(aes(npcx=0.5,npcy=0.05,label="68%"),
                         size=7,color="white") +
  stat_function(fun=dnorm,args=list(mean=mn,sd=sd),xlim=c(mn-4*sd,mn-1*sd),
                geom="area",fill="red",color="black",size=1.1) +
  ggpmisc::geom_text_npc(aes(npcx=0.1,npcy=0.2,label="16%"),
                         size=7,color="black",hjust=0)
```
</div>

&nbsp;

<ol start="8">
  <li>The heaviest 2.5% of wood ducks weigh more than 550 g.</li>
</ol>

<div class="alert alert-warning">
<p>Again, this percentage should sound familiar from the previous questions. With that experience you know that 2.5% is in the tails outside of the 95% range. This questions asks for the heaviest wood ducks so it would be to right (or upper) tail of the normal distribution. Thus, the heaviest 2.5% of wood ducks are more than 2&sigma; above &mu; (=550).</p>

```{r echo=FALSE}
b + 
  stat_function(fun=dnorm,args=list(mean=mn,sd=sd),xlim=c(mn-2*sd,mn+2*sd),
                geom="area",fill="gray40",color="black",size=1.1) +
  ggpmisc::geom_text_npc(aes(npcx=0.5,npcy=0.05,label="95%"),
                         size=7,color="white") +
  stat_function(fun=dnorm,args=list(mean=mn,sd=sd),xlim=c(mn+2*sd,mn+4*sd),
                geom="area",fill="red",color="black",size=1.1) +
  ggpmisc::geom_text_npc(aes(npcx=0.97,npcy=0.1,label="2.5%"),
                         size=7,color="black",hjust=1)
```
</div>
