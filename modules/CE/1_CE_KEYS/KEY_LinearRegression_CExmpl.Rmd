---
title: "Answer Key"
subtitle: "Linear Regression Class Example"
author: Derek H. Ogle
layout: page
css: "/css/modules.css"
output:
  html_document:
    fig_height: 3.5
    fig_width: 3.5
    self_contained: false
---

```{r echo=FALSE, eval=FALSE}
## Renders an appropriate HTML file and moves to CE directory
source("1_CE_Keys/zzz_modHTML_CEKeys.R")
modHTML_CEKeys("KEY_LinearRegression_CExmpl")
```
```{r echo=FALSE, results='hide', message=FALSE, warning=FALSE}
library(NCStats)
source("../../../rhelpers/knitr_setup.R")
```

----

## Climate Change Data
```{r CCDCalc, echo=FALSE,results="hide",message=FALSE}
library(NCStats)
library(ggplot2)
df <- read.csv("C:/aaaWork/Web/GitHub/NCMTH107/modules/CE/GSI_data.csv")
ggplot(data=df,mapping=aes(x=CO2,y=Temp)) +
  geom_point(pch=21,color="black",fill="darkgray",size=2) +
  geom_smooth(method="lm",se=FALSE,color="red",size=1) +
  stat_SLR_equation(aes(label=..eq.label..),
                    label.x.npc=0,label.y.npc=1,cf.digits=c(1,2)) +
  stat_SLR_equation(aes(label=..rr.label..),label.x.npc=0,label.y.npc=0.90) +
  labs(x="CO2 in Atmosphere (ppm)",y="Temperature Anomaly (1/100C)") +
  theme_NCStats() +
  theme(aspect.ratio=1)
lm1 <- lm(Temp~CO2,data=df)
slp <- round(coef(lm1)[[2]],2)
int <- round(coef(lm1)[[1]],1)
rsq <- rSquared(lm1,digits=2)
r <- round(sqrt(rsq),2)
xs <- c(360,380)
preds <- slp*xs+int
resid <- 40-preds[2]
```

<ol start="1">
<li>The response variable is temperature anomaly.</li>
</ol>

<div class="alert alert-warning">
<ul>
  <li>Temperature anomaly is the response variable because in the background we are told that "to determine if the variability in the temperature anomaly records can be reasonably explained by the CO2 values". The response variable is the variable being explained. Additionally, the response variable is the variable to be predicted. In questions 6 and 7, it is clear that temperature anomaly is being predicted.</li>
  <li>Once you have identified the response variable that will make it clear which plot to use as the response variable is on the y-axis. Thus, in this case, use the left plot (reproduced above for convenience) and COMPLETELY IGNORE the other plot.</li>
</ul>
</div>


<ol start="2">
<li>The explanatory variable is the CO<sub>2</sub> recordings.</li>
</ol>

<div class="alert alert-warning">
<ul>
  <li>The explanatory variable is simply the "other" variable (i.e., not the response variable).</li>
</ul>
</div>


<ol start="3">
<li>The equation of the best fit line is TEMP=`r slp`CO2-`r abs(int)`.</li>
</ol>

<div class="alert alert-warning">
<ul>
  <li>This formula is written in Y=mX+b format and can be read directly from the equation on the plot.</li>
  <li>Make sure, however, that you replace Y and X with the names of the actual variables in the problem (TEMP and CO2 in this case).</li>
</ul>
</div>


<ol start="4">
<li>The slope indicates that for every 1 ppm increase in CO<sub>2</sub> the temperature anomaly will increase `r slp` 1/100<sup>o</sup>C, on average.</li>
</ol>

<div class="alert alert-warning">
<ul>
  <li>The slope is the value that is multiplied by X or the explanatory variable.</li>
  <li>The slope interpretation is always how much Y changes for a one unit change in X; however, replace Y and X with the actual variable names.</li>
  <li>The best-fit line represents an average summary of the relationship between Y and X. Thus, the slope only represents an average change; therefore, you must include "on average" in your interpretation of the slope.</li>
</ul>
</div>


<ol start="5">
<li>The intercept indicates that the temperature anomaly will be `r int` 1/100<sup>o</sup>C on average when the CO<sub>2</sub> in the atmosphere is 0 ppm.</li>
</ol>

<div class="alert alert-warning">
<ul>
  <li>The intercept is the value in the equation not multiplied by X.</li>
  <li>The intercept will always be what the value of Y is when X is 0.</li>
  <li>You must include "on average" here for the same reason as described for the slope.</li>
  <li>The y-intercept will often not make sense because 0 is often not within the observed range of X values (as is clearly the case here).</li>
</ul>
</div>


<ol start="6">
<li>The temperature anomaly is predicted to be `r preds[1]` 1/100<sup>o</sup>C when the CO<sub>2</sub> is 360 ppm.</li>
</ol>

<div class="alert alert-warning">
<ul>
  <li>Before making a prediction make sure the value of X is within the range of observed X values. It is in this case so it is OK to make this prediction.</li>
  <li>This prediction is made by plugging 360 in for CO2 as shown below.</li>
  
  \[ TEMP=`r slp`*360-`r abs(int)` \]
</ul>
</div>


<ol start="7">
<li>The prediction should not be made as it is an extrapolation.</li>
</ol>

<div class="alert alert-warning">
<ul>
  <li>Before making a prediction make sure the value of X is within the range of observed X values. It is NOT in this case so it is either NOT OK to make this prediction or you should acknowledge that the prediction could be wrong because it is an extrapolation.</li>
</ul>
</div>


<ol start="8">
<li>The residual if the temperature anomaly is 40 1/100<sup>o</sup>C and the CO<sub>2</sub> is 380 ppm is `r resid` 1/100<sup>o</sup>C.</li>
</ol>

<div class="alert alert-warning">
<ul>
  <li>Computing a residuals requires predicting the value of Y at the given value of X. Thus, make sure the given value of X is with the observed range of X values. It is in this case so it is OK to make the prediction and proceed with the calculation.</li>
  <li>The predicted temperature anomaly for the given CO<sub>2</sub> value is `r preds[2]` 1/100<sup>o</sup>C. This calculation is shown below.</li>

  \[ TEMP=`r slp`*380-`r abs(int)` \]
  
  <li>The residual is computed as the observed Y minus the predicted Y, as shown below.</li>
  
  \[ RESIDUAL = 40 - `r preds[2]` \]
</ul>
</div>


<ol start="9">
<li>The proportion of the variability in temperature anomaly that is explained by knowing the CO<sub>2</sub> amount is `r rsq`.</li>
</ol>

<div class="alert alert-warning">
<ul>
  <li>The words "proportion of variability ... explained" can only mean the r<sup>2</sup> value. Thus, simply report that value.</li>
</ul>
</div>


<ol start="10">
<li>The correplation coefficient between temperature anomaly and CO<sub>2</sub> amount is `r r`.</li>
</ol>

<div class="alert alert-warning">
<ul>
  <li>The correlation coefficient is symbolized with r, so simply take the square roo of r<sup>2</sup>.</li>
  <li>However, if the slope had been negative you would need to add a negative sign to the square root result.</li>
</ul>
</div>


<ol start="11">
<li>If the CO<sub>2</sub> amount were to increase by 20 ppm, then the temperature anomaly would be expected to increase by `r round(20*slp,digits=2)` 1/100<sup>o</sup>C.</li>
</ol>

<div class="alert alert-warning">
<ul>
  <li>This is largely another question about the slope. The slope says how much Y increases if X increases by 1. Thus, with this question we would expect Y to increase by 20 slopes as X increases by 20 units.</li>
</ul>
</div>


<ol start="12">
<li>I do not have any concerns about this best fit line because the form of the scatterplot is linear and the variability around the line is largely equal (i.e., it is homoscedastic). In other words, the form is NOT curved and the points are NOT funnel-shaped, so the regression assumptions are adequately met.</li>
</ol>

<div class="alert alert-warning">
<ul>
  <li>With this question you should address the linearity and homoscedasticity assumptions. Linearity is met if the form is not curved. Homoscedasticity is met if the points don't form a funnel of some sort..</li>
</ul>
</div>
