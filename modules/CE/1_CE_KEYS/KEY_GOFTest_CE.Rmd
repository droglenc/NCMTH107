---
title: "Answer Key"
subtitle: "Goodness-of-Fit Assignment"
author: Derek H. Ogle
layout: page
css: "/css/modules.css"
output:
  html_document:
    self_contained: false
---

```{r echo=FALSE, eval=FALSE}
## Renders an appropriate HTML file and moves to CE directory
source("modules/CE/1_CE_Keys/zzz_modHTML_CEKeys.R")
modHTML_CEKeys("KEY_GOFTest_CE")
```

```{r echo=FALSE, results='hide', message=FALSE}
library(NCStats)
source("../../../rhelpers/knitr_setup.R")
library(captioner)
tbls <- captioner(prefix="Table")

tbls(name="WaterExpTable","Expected frequency of students (assuming that Ho is true) by water type choice.")
tbls(name="WaterObsTable","Observed frequency of students by water type choice.")

tbls(name="TurkeyExpTable","Expected frequency of turkeys (assuming that Ho is true) by habitat in the spring.")
tbls(name="TurkeyObsTable","Observed frequency of turkeys by habitat in the spring.")

tbls(name="JuryExpTable","Expected frequency of jurors (assuming that Ho is true) by age category.")
tbls(name="JuryObsTable","Observed frequency of jurors by age category.")
```

----

## Preference for Bottled Water?

```{r WaterCalc, echo=FALSE, results='hide', fig.show='hide', warning=FALSE}
w.obs <- c(tap=51,Aquafina=18,Fiji=17,Sams=21)
w.exp <- c(tap=1,Aquafina=1,Fiji=1,Sams=1)/4
w.chi <- chisq.test(w.obs,p=w.exp,rescale.p=TRUE,correct=FALSE)
w.chi
gofCI(w.chi,digits=3,conf.level=0.99)
```

<ol>
<li>&alpha;=0.01.</li>
<li>H<sub>A</sub>: "There is a preference among the water choices (i.e., the distribution of students will NOT follow a theoretical distribution of equal proportions among the water choices)" and H<sub>0</sub>: "There is no preference among the water choices (i.e., the distribution of students will follow a theoretical distribution of equal proportions among the water choices)".</li>
<li>Goodness-of-fit test because (i) one group or population (students) were sampled and (ii) the response variable (water choice) is categorial.</li>
<li>This is quasi-experimental as the students were given a choice of only certain waters. The students were not obviously randomly selected (and were likely part of a voluntary response survey).</li>
<li>All cells in the expected frequency table (`r tbls("WaterExpTable",display="cite")`) were greater than 5; the assumptions for a goodness-of-fit test have been met.</li>

`r tbls("WaterExpTable")`

```{r echo=FALSE}
w.chi$expected
```

<li>The observed frequency table is shown in `r tbls("WaterObsTable",display="cite")`.</li>

`r tbls("WaterObsTable")`

```{r echo=FALSE}
w.chi$observed
```

<li>&chi;<sup>2</sup>=$\frac{(51-26.75)^{2}}{26.75}$ + $\frac{(18-26.75)^{2}}{26.75}$ +$\frac{(17-26.75)^{2}}{26.75}$ +$\frac{(21-26.75)^{2}}{26.75}$=`r formatC(w.chi$statistic,format="f",digits=4)` with `r w.chi$parameter` df.</li>
<li>p-value`r kPvalue(w.chi$p.value,include.p=FALSE,latex=FALSE)` (more specifically `r formatC(w.chi$p.value,digits=4)`).</li>
<li>Reject H<sub>0</sub> because the p-value&lt;&alpha;.</li>
<li>It appears that there is a preference for water type by the students. Further examination suggests that the students preferred the tap water.</li>
<li>Not required for a goodness-of-fit test</li>
</ol>

R Appendix.
```{r eval=FALSE, prompt=FALSE}
library(NCStats)
distrib(29.6355,distrib="chisq",df=3,lower.tail=FALSE)
```

----

## Habitat Use by Wild Turkeys

```{r TurkeyCalc, echo=FALSE, results='hide', fig.show='hide', warning=FALSE}
t.obs <- c(Aspen=61,Meadow=9,Pine=807,OakSpruce=1)
t.exp <- c(Aspen=0.0516,Meadow=0.1016,Pine=0.8371,OakSpruce=0.0100)
t.chi <- chisq.test(t.obs,p=t.exp,rescale.p=TRUE,correct=FALSE)
t.chi
gofCI(t.chi,digits=3)
```

<ol>
<li>&alpha;=0.05.</li>
<li>H<sub>A</sub>: "There is a preference by the turkeys for habitat (i.e., the distribution of turkeys will NOT follow the distribution of available habitats)" and H<sub>0</sub>: "There is NOT a preference by the turkeys for habitat (i.e., the distribution of turkeys will follow the distribution of available habitats)".</li>
<li>Goodness-of-fit test because (i) one group or population (South Dakota turkeys) were sampled and (ii) the response variable (habitat use) is categorical.</li>
<li>This is observational as habitat use by the turkeys was simply recorded. The turkey observations were not randomly selected (the researchers likely chose days to sample).</li>
<li>All cells in the expected frequency table (`r tbls("TurkeyExpTable",display="cite")`) were greater than 5; the assumptions for a goodness-of-fit test have been met.</li>

`r tbls("TurkeyExpTable")`

```{r echo=FALSE}
t.chi$expected
```

<li>The observed frequency table is shown in `r tbls("TurkeyObsTable",display="cite")`.</li>

`r tbls("TurkeyObsTable")`

```{r echo=FALSE}
t.chi$observed
```

<li>&chi;<sup>2</sup>=$\frac{(61-45.291213)^{2}}{45.291213}$ + $\frac{(9-89.178047)^{2}}{89.178047}$ +$\frac{(807-734.753374)^{2}}{734.753374}$ +$\frac{(1-8.777367)^{2}}{8.777367}$=`r formatC(t.chi$statistic,format="f",digits=4)` with `r t.chi$parameter` df (`r tbls("TurkeyResults",display="cite")`).</li>
<li>p-value`r kPvalue(t.chi$p.value,include.p=FALSE,latex=FALSE)` (somewhat more specifically `r formatC(t.chi$p.value,digits=3)`).</li>
<li>Reject H<sub>0</sub> because the p-value&lt;&alpha;.</li>
<li>It appears that the turkeys show a habitat preference in the spring. Further analysis suggests that the turkeys showed a strong avoidance of meadows, a moderate avoidance of Oak/Spruce habitats, and a moderate preference for aspen and pine habitats.</li>
<li>Not required for a goodness-of-fit test.</li>
</ol>

R Appendix.
```{r eval=FALSE, prompt=FALSE}
library(NCStats)
distrib(91.5299,distrib="chisq",df=3,lower.tail=FALSE)
```

----

## Random Jury Pool

```{r JuryCalc, echo=FALSE, results='hide', fig.show='hide', warning=FALSE}
j.obs <- c("18-19"=23,"20-24"=96,"25-29"=134,"30-39"=293,
           "40-49"=297,"50-64"=380,"65+"=113)
j.exp <- c("18-19"=6.1,"20-24"=15.0,"25-29"=13.5,"30-39"=21.7,
           "40-49"=15.3,"50-64"=18.2,"65+"=10.2)
j.chi <- chisq.test(j.obs,p=j.exp,rescale.p=TRUE,correct=FALSE)
j.chi
gofCI(j.chi,digits=3)
```

<ol>
<li>&alpha;=0.10.</li>
<li>H<sub>A</sub>: "The age distribution of the actual jury is not the same as the age distribution in the district as a whole" and H<sub>0</sub>: "The age distribution of the actual jury is the same as the age distribution in the district as a whole".</li>
<li>Goodness-of-fit test because (i) one group or population (the jury in this district) were sampled and (ii) the response variable (age category) is categorial.</li>
<li>This is observational as the jurors were not allocated to ages. In theory the jury was randomly selected from the district, but that is what is being tested.</li>
<li>All cells in the expected frequency table (`r tbls("JuryExpTable",display="cite")`) were greater than 5; the assumptions for a goodness-of-fit test have been met.</li>

`r tbls("JuryExpTable")`

```{r echo=FALSE}
j.chi$expected
```

<li>The observed frequency table is shown in `r tbls("JuryObsTable",display="cite")`.</li>

`r tbls("JuryObsTable")`

```{r echo=FALSE}
j.chi$observed
```

<li>&chi;<sup>2</sup>=$\frac{(23-81.496)^{2}}{81.496}$ + $\frac{(96-200.400)^{2}}{200.400}$ +$\frac{(134-180.360)^{2}}{180.360}$ +$\frac{(293-289.912)^{2}}{289.912}$+$\frac{(297-204.408)^{2}}{204.408}$+$\frac{(380-243.152)^{2}}{243.152}$+$\frac{(113-136.272)^{2}}{136.272}$=`r formatC(j.chi$statistic,format="f",digits=4)` with `r j.chi$parameter` df (`r tbls("JuryResults",display="cite")`).</li>
<li>p-value`r kPvalue(j.chi$p.value,include.p=FALSE,latex=FALSE)` (somewhat more specifically `r formatC(j.chi$p.value,digits=3)`).</li>
<li>Reject H<sub>0</sub> because the p-value&lt;&alpha;.</li>
<li>It appears that the age distribution of the jury does not match the age distribution of the district as a whole. Further examination suggests that the jury has a higher percentage of older jurors (ages "40-49" and "50-64") and a lower percentage of younger jurors (ages "18-19", "20-24", and "25-29") than expected as based on the age distribution in the district as a whole.</li>
<li>Not required for a goodness-of-fit test.</li>
</ol>

R Appendix.
```{r eval=FALSE, prompt=FALSE}
library(NCStats)
distrib(231.2600,distrib="chisq",df=6,lower.tail=FALSE)
```
