---
title: "Answer Key"
subtitle: "Chi-Square Assignment"
author: Derek H. Ogle
layout: page
css: "/css/modules.css"
output:
  html_document:
    fig_height: 3.5
    fig_width: 3.5
    self_contained: false
---

```{r echo=FALSE, eval=FALSE}
## Renders an appropriate HTML file and moves to CE directory
source("modules/CE/1_CE_Keys/zzz_modHTML_CEKeys.R")
modHTML_CEKeys("KEY_ChiSquare_CE")
```

```{r echo=FALSE, results='hide', message=FALSE, warning=FALSE}
library(NCStats)
source("../../../rhelpers/knitr_setup.R")
library(captioner)
tbls <- captioner(prefix="Table")

tbls(name="hurr1","Expected frequency table for distribution of hurricanes into the strength and time period categories.")
tbls(name="hurr2","Observed frequency table for distribution of hurricanes into the strength and time period categories.")
tbls(name="hurr4","Row percentage table for the observations of hurricane strengths by time period.")

tbls("HelloExp","Expected frequencies of people that responded to 'Hello' and group size.")
tbls("HelloObs","Observed frequencies of people that responded to 'Hello' and group size.")
tbls("HelloPerc","The percentage of people that responded to 'Hello' by group size.")
```

----

<div class="alert alert-warning">
<strong>Note:</strong> 
<ul>
<li>Make sure to describe your evidence in Step 3 for why you are performing a chi-square test. It is not adequate to simply say "because there is a categorical response variable and two or more groups are being tests." At least say what the response variable is and what the groups are.</li>
<li>When testing the assumptions (Step 5), make sure to explicitly say that there are more than five in each cell of the expected table. It is not adequate to simply make the expected table.</li>
<li>In hand-calculation questions (e.g., hurricanes) make sure to put `lower.tail=FALSE` in `distrib()` when calculating the p-value (Step 8) in a chi-square problem. This is true for EVERY chi-square problem.</li>
<li>You values may differ slightly from mine as I calculate everything in R that holds many decimal places on intermediate values.</li>
</ul>
</div>

----

## Hurricane Strengths
```{r HurrCalc, echo=FALSE, results='hide'}
obs <- matrix(c(51,26,8,44,21,7),nrow=2,byrow=TRUE)
rownames(obs) <- c("1901-1950","1951-2000")
colnames(obs) <- c("Cat 1&2","Cat 3","Cat 4&5")
( hurr.chi <- chisq.test(obs,correct=FALSE) )
```

<ol>
  <li>&alpha;=0.10.</li>
  <li>H<sub>0</sub>: "The distribution of hurricanes into the strength categories is the same for both time periods" versus H<sub>A</sub>: "The distribution of hurricanes into the strength categories is NOT the same for both time periods"</li>
  <li>A chi-square test is required because (i) a categorical response variable with three levels (strength category) from (ii) two groups or populations (time periods) was recorded.</li>
  <li>This is an observational study without obvious randomization.</li>
  <li>The test statistic computed below should reasonably follow a chi-square distribution because all cells in the expected table (`r tbls("hurr1",display="cite")`) have values greater than five.</li>

`r tbls("hurr1")`

```{r HurrExpTable,echo=FALSE,background="white"}
round(hurr.chi$expected,1)
```

  <li>The table of observed frequencies were given as in `r tbls("hurr2",display="cite")`.</li>

`r tbls("hurr2")`

```{r echo=FALSE,background="white"}
hurr.chi$observed
```

  <li>The &chi;<sup>2</sup> test statistic is  $\frac{(51-51.4)^{2}}{51.4}$ + $\frac{(26-25.4)^{2}}{25.4}$ +$\frac{(8-8.1)^{2}}{8.1}$ +$\frac{(44-43.6)^{2}}{43.6}$ +$\frac{(21-21.6)^{2}}{21.6}$ +$\frac{(7-6.9)^{2}}{6.9}$ = 0.0036+0.0121+0.0018+0.0043+0.0142+0.0021 = `r formatC(hurr.chi$statistic,format="f",digits=4)` with `r formatC(hurr.chi$parameter,format="f",digits=0)` df.</li>
  <li>The p-value is `r kPvalue(hurr.chi$p.value,include.p=FALSE,latex=FALSE)`.</li>
  <li>The H<sub>0</sub> is rejected because the p-value<&alpha;.</li>
  <li>It appears that the distribution of hurricanes into the strength categories is the same for both time periods (`r tbls("hurr4",display="cite")`).</li>

`r tbls("hurr4")`

```{r HurrResids,echo=FALSE,background="white"}
percTable(obs,margin=1,digits=1)
```

  <li>Not required for a chi-square test.</li>
</ol>

R Appendix.
```{r eval=FALSE,prompt=FALSE}
library(NCStats)
distrib(0.0382,distrib="chisq",df=2,lower.tail=FALSE)
```

----

## Response to Hello
```{r HelloChi, echo=FALSE, results='hide'}
obs <- matrix(c(92,65,13,119-92,94-65,27-13),nrow=3)
rownames(obs) <- c("Individual","Two or Three","Four or more")
colnames(obs) <- c("Responded","Did Not Respond")
( chi1 <- chisq.test(obs,correct=FALSE) )
```

<ol>
<li>&alpha; = 0.10.</li>
<li>The H<sub>0</sub>: "The distribution of groups into whether they responded or not to the 'Hello' is the same for all three group sizes" versus H<sub>0</sub>: "The distribution of groups into whether they responded or not to the 'Hello' is NOT the same for all three group sizes."</li>
<li>A chi-square test is required because (i)a categorical variable with two levels (response or not) was measured on (ii) three groups/populations (group sizes).</li>
<li>The data appear to be part of an observational study where the ``groups" were not randomly selected.</li>
<li>The test statistic below should follow a &chi;<sup>2</sup> distribution because the expected number in each cell is greater than five (`r tbls("HelloExp",display="cite")`).</li>

`r tbls("HelloExp")`

```{r HelloExp, echo=FALSE, background='white', comment=""}
chi1$expected
```

<li>The observed frequency table is in `r tbls("HelloObs",display="cite")`.</li>

`r tbls("HelloObs")`

```{r HelloObs, echo=FALSE, background='white', comment=""}
chi1$observed
```

<li>The &chi;<sup>2</sup> test statistic is $\frac{(92-84.29167)^{2}}{84.29167}$ + $\frac{(27-34.70833)^{2}}{34.70833}$ +$\frac{(65-66.58333)^{2}}{66.58333}$ +$\frac{(29-27.41667)^{2}}{27.41667}$ +$\frac{(13-19.125)^{2}}{19.125}$ +$\frac{(14-7.875)^{2}}{7.875}$ = 0.705+ 0.038+ 1.962+ 1.712+ 0.091+ 4.764= 9.271 with (3-1)(2-1)=2 df.</li>
<li>The p-value is `r kPvalue(chi1$p.value,include.p=FALSE,latex=FALSE)`.</li>
<li>The H<sub>0</sub> is rejected because the p-value < &alpha;.</li>
<li>There is a difference in the responsiveness among the three sizes of groups. It appears that the groups with 4,5,6 individuals responded less frequently than the individuals and groups of 2 and 3 (`r tbls("HelloPerc",display="cite")`).</li>

`r tbls("HelloPerc")`

```{r HelloPerc, echo=FALSE, background='white', comment=""}
percTable(chi1$observed,margin=1)
```

<li>Not needed for a chi-square test.</li>
</ol>

R Appendix.
```{r eval=FALSE,prompt=FALSE}
library(NCStats)
distrib(9.271,distrib="chisq",df=2,lower.tail=FALSE)
