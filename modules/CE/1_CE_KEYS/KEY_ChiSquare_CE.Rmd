---
title: "Answer Key"
subtitle: "Chi-Square Assignment"
author: Derek H. Ogle
layout: page
css: "/css/modules.css"
output:
  html_document:
    fig_height: 3.5
    fig_width: 3.5
    self_contained: false
---

```{r echo=FALSE, eval=FALSE}
## Renders an appropriate HTML file and moves to CE directory
source("modules/CE/1_CE_Keys/zzz_modHTML_CEKeys.R")
modHTML_CEKeys("KEY_ChiSquare_CE")
```

```{r echo=FALSE, results='hide', message=FALSE, warning=FALSE}
library(NCStats)
source("../../../rhelpers/knitr_setup.R")
library(captioner)
tbls <- captioner(prefix="Table")

tbls(name="hurr1","Expected frequency table for distribution of hurricanes into the strength and time period categories.")
tbls(name="hurr2","Observed frequency table for distribution of hurricanes into the strength and time period categories.")
tbls(name="hurr4","Row percentage table for the observations of hurricane strengths by time period.")

tbls("HelloExp","Expected frequencies of people that responded to 'Hello' and group size.")
tbls("HelloObs","Observed frequencies of people that responded to 'Hello' and group size.")
tbls("HelloPerc","The percentage of people that responded to 'Hello' by group size.")

tbls("TEDSExp","Expected frequencies of trawl tows with at least one turtle mortality by two sizes of openings.")
tbls("TEDSObs","Observed frequencies of trawl tows with at least one turtle mortality by two sizes of openings.")
tbls("TEDSPerc","The percentage of trawl tows with at least one turtle mortality by two sizes of openings.")
```

----

<div class="alert alert-warning">
<strong>Note:</strong> 
<ul>
<li>Make sure to describe your evidence in Step 3 for why you are performing a chi-square test. It is not adequate to simply say "because there is a categorical response variable and two or more groups are being tests." At least say what the response variable is and what the groups are.</li>
<li>When testing the assumptions (Step 5), make sure to explicitly say that there are more than five in each cell of the expected table. It is not adequate to simply make the expected table.</li>
<li>In hand-calculation questions (e.g., hurricanes) make sure to put `lower.tail=FALSE` in `distrib()` when calculating the p-value (Step 8) in a chi-square problem. This is true for EVERY chi-square problem.</li>
<li>You values may differ slightly from mine as I calculate everything in R that holds many decimal places on intermediate values.</li>
</ul>
</div>

----

## Hurricane Strengths
```{r HurrCalc, echo=FALSE, results='hide'}
obs <- matrix(c(51,26,8,44,21,7),nrow=2,byrow=TRUE)
rownames(obs) <- c("1901-1950","1951-2000")
colnames(obs) <- c("Cat 1&2","Cat 3","Cat 4&5")
( hurr.chi <- chisq.test(obs,correct=FALSE) )

## Recalculate using rounding on expected values and residuals
exp <- round(hurr.chi$expected,1)
resids <- round(((obs-exp)^2)/exp,3)
sum(resids)
```

<ol>
  <li>&alpha;=0.10.</li>
  <li>H<sub>0</sub>: "The distribution of hurricanes into the strength categories is the same for both time periods" versus H<sub>A</sub>: "The distribution of hurricanes into the strength categories is NOT the same for both time periods"</li>
  <li>A chi-square test is required because (i) a categorical response variable with three levels (strength category) from (ii) two groups or populations (time periods) was recorded.</li>
  <li>This is an observational study without obvious randomization.</li>
  <li>The test statistic computed below should reasonably follow a chi-square distribution because all cells in the expected table (`r tbls("hurr1",display="cite")`) have values greater than five.</li>

`r tbls("hurr1")`

```{r HurrExpTable,echo=FALSE,background="white"}
round(hurr.chi$expected,1)
```

  <li>The table of observed frequencies were given as in `r tbls("hurr2",display="cite")`.</li>

`r tbls("hurr2")`

```{r echo=FALSE,background="white"}
addmargins(hurr.chi$observed)
```

  <li>The &chi;<sup>2</sup> test statistic is  $\frac{(51-51.4)^{2}}{51.4}$ + $\frac{(26-25.4)^{2}}{25.4}$ +$\frac{(8-8.1)^{2}}{8.1}$ +$\frac{(44-43.6)^{2}}{43.6}$ +$\frac{(21-21.6)^{2}}{21.6}$ +$\frac{(7-6.9)^{2}}{6.9}$ = 0.0036+0.0121+0.0018+0.0043+0.0142+0.0021 = `r formatC(hurr.chi$statistic,format="f",digits=4)` with `r formatC(hurr.chi$parameter,format="f",digits=0)` df.</li>
  <li>The p-value is `r kPvalue(hurr.chi$p.value,include.p=FALSE,latex=FALSE)`.</li>
  <li>The H<sub>0</sub> is not rejected because the p-value>&alpha;.</li>
  <li>It appears that the distribution of hurricanes into the strength categories is the same for both time periods (`r tbls("hurr4",display="cite")`).</li>

`r tbls("hurr4")`

```{r HurrResids,echo=FALSE,background="white"}
percTable(obs,margin=1,digits=1)
```

  <li>Not required for a chi-square test.</li>
</ol>

R Appendix.
```{r eval=FALSE,prompt=FALSE}
library(NCStats)
distrib(0.0382,distrib="chisq",df=2,lower.tail=FALSE)
```

----

## Response to Hello
```{r HelloChi, echo=FALSE, results='hide'}
obs <- matrix(c(92,65,13,119-92,94-65,27-13),nrow=3)
rownames(obs) <- c("Individual","Two or Three","Four or more")
colnames(obs) <- c("Responded","Did Not Respond")
( chi1 <- chisq.test(obs,correct=FALSE) )
```

<ol>
<li>&alpha; = 0.05.</li>
<li>The H<sub>0</sub>: "The distribution of groups into whether they responded or not to the 'Hello' is the same for all three group sizes" versus H<sub>0</sub>: "The distribution of groups into whether they responded or not to the 'Hello' is NOT the same for all three group sizes."</li>
<li>A chi-square test is required because (i)a categorical variable with two levels (response or not) was measured on (ii) three groups/populations (group sizes).</li>
<li>This study is experimental in that the the researchers intervened with the subjects (i.e., said "Hello" to them) but it is observational in the sense that the "groups" (number of peple together) were not created by the researcher. It is clear that the "groups" were not randomly selected.</li>
<li>The test statistic below should follow a &chi;<sup>2</sup> distribution because the expected number in each cell is greater than five (`r tbls("HelloExp",display="cite")`).</li>

`r tbls("HelloExp")`

```{r HelloExp, echo=FALSE, background='white', comment=""}
round(chi1$expected,1)
```

<li>The observed frequency table is in `r tbls("HelloObs",display="cite")`.</li>

`r tbls("HelloObs")`

```{r HelloObs, echo=FALSE, background='white', comment=""}
addmargins(chi1$observed)
```

<li>The &chi;<sup>2</sup> test statistic is $\frac{(92-84.3)^{2}}{84.3}$ + $\frac{(27-34.7)^{2}}{34.7}$ +$\frac{(65-66.6)^{2}}{66.6}$ +$\frac{(29-27.4)^{2}}{27.4}$ +$\frac{(13-19.1)^{2}}{19.1}$ +$\frac{(14-7.9)^{2}}{7.9}$ = 0.703+ 1.709+ 0.038+ 0.093+ 1.948+ 4.710= 9.201 with (3-1)(2-1)=2 df.</li>
<li>The p-value is `r kPvalue(distrib(9.201,distrib="chisq",df=2,lower.tail=FALSE),include.p=FALSE,latex=FALSE)`.</li>
<li>The H<sub>0</sub> is rejected because the p-value < &alpha;.</li>
<li>There is a difference in the responsiveness among the three sizes of groups. It appears that the groups with 4,5,6 individuals responded less frequently than the individuals and groups of 2 and 3 (`r tbls("HelloPerc",display="cite")`).</li>

`r tbls("HelloPerc")`

```{r HelloPerc, echo=FALSE, background='white', comment=""}
percTable(chi1$observed,margin=1)
```

<li>Not needed for a chi-square test.</li>
</ol>

R Appendix.
```{r eval=FALSE,prompt=FALSE}
library(NCStats)
distrib(9.201,distrib="chisq",df=2,lower.tail=FALSE)
```

----

## Turtle Excluder Devices
```{r TEDSChi, echo=FALSE, results='hide'}
obs <- matrix(c(16,75-16,8,88-8),nrow=2,byrow=TRUE)
rownames(obs) <- c("original","new")
colnames(obs) <- c("mortality","no mortality")
( chi1 <- chisq.test(obs,correct=FALSE) )
```

<li>&alpha; = 0.10.</li>
<li>The H<sub>0</sub>: "The distribution of tows with zero or at least one turtle mortality is the same between the two sizes of openings" versus H<sub>A</sub>: "The distribution of tows with zero or at least one turtle mortality is NOT the same between the two sizes of openings."</li>
<li>A chi-square test is required because (i)a categorical variable with two levels (at least one turtle mortality or not) was measured on (ii) two groups/populations (different sized TED openings).</li>
<li>An observation study (it seems that the tows were just made and observed, not explicitly controlled by an experimenter) that is not obviously a random sample was used.</li>
<li>The test statistic below should follow a &chi;<sup>2</sup> distribution because the expected number in each cell is greater than five (`r tbls("TEDSExp",display="cite")`).</li>

`r tbls("TEDSExp")`

```{r TEDSExp, echo=FALSE, background='white', comment=""}
chi1$expected
```

<li>The table of observed frequencies is in `r tbls("TEDSObs",display="cite")`.</li>

`r tbls("TEDSObs")`

```{r TEDSObs, echo=FALSE, background='white', comment=""}
chi1$observed
```

<li>The &chi;<sup>2</sup> test statistic is `r formatC(chi1$statistic,format="f",digits=3)` with `r chi1$parameter` df.</li>
<li>The p-value for this test statistic is `r kPvalue(chi1$p.value,include.p=FALSE,latex=FALSE)`.</li>
<li>The H<sub>0</sub> is rejected because the p-value < &alpha;.</li>
<li>There appears to be a difference in the distribution of tows with zero and at least one turtle mortality between the two opening sizes. In fact, it appears that significantly fewer tows with the new, larger opening had at least one turtle mortality (`r tbls("TEDSPerc",display="cite")`).</li>

`r tbls("TEDSPerc")`

```{r TEDSPerc, echo=FALSE, background='white', comment=""}
percTable(chi1$observed,margin=1)
```

<li> Not needed for a chi-square test.</li>

### R Appendix
```{r eval=FALSE}
<<TEDSChi>>
<<TEDSExp>>
<<TEDSPerc>>
```
