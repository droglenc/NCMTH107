---
title: "Answer Key"
subtitle: "R t-test Assignment"
author: Derek H. Ogle
layout: page
css: "/css/modules.css"
output:
  html_document:
    self_contained: false
---

```{r echo=FALSE, eval=FALSE}
## Renders an appropriate HTML file and moves to CE directory
source("modules/CE/1_CE_Keys/zzz_modHTML_CEKeys.R")
modHTML_CEKeys("KEY_Rttests_CE")
```

```{r echo=FALSE, results='hide', message=FALSE}
library(NCStats)
library(ggplot2)
source("../../../rhelpers/knitr_setup.R")
```

<br>

# Acid Rain in Shenandoah National Park
```{r echo=FALSE}
ph <- read.csv("https://github.com/droglenc/NCData/raw/master/pHlevels.csv")
```
```{r pHCalc, echo=FALSE, results='hide'}
( ph.t <- t.test(ph$pH,mu=5.6,alt="less",conf.level=0.99) )
```

1. &alpha;=0.01.
1. H<sub>A</sub>:&mu;<5.6 and H<sub>0</sub>:&mu;=5.6, where &mu; is the mean pH for all rainwater collections at the Big Meadows Station in the Shenandoah National Park, VA.
1. A one-sample t-test is required because quantitative variable (pH) was measured on individuals from one group or population (all rainwater collections at Big Meadows Station), &sigma; is UNknown, and the population mean is being compared to a specific value in the hull hypothesis.
1. An observational study without obvious randomization was used.
1. The assumptions are met because &sigma; is unknown and m=`r formatC(ph.t$parameter+1,format="f",digits=0)`&ge;40. Thus, the sampling distribution of the test statistic should follow a t-distribution.
1. The statistic is x&#772;=`r formatC(ph.t$estimate,format="f",digits=3)`.
1. The test statistic is t=`r formatC(ph.t$statistic,format="f",digits=3)` with `r formatC(ph.t$parameter,format="f",digits=0)` df.
1. The p-value is `r kPvalue(ph.t$p.value,include.p=FALSE,latex=FALSE)`.
1. The H<sub>0</sub> is rejected because the p-value<&alpha;.
1. The mean pH appears to be significantly lower than 5.6 and, thus, indicates acid rain at this site.
1. One is 99% confident that the mean pH level is less than `r formatC(ph.t$conf.int[2],format="f",digits=2)`, which further indicates acid rain at this site.

#### R Code and Results
```{r eval=FALSE}
d <- read.csv("pHlevels.csv")
```
```{r}
<<pHCalc>>
```

<br>

----

# Delivering Military Supplies
```{r DeliveriesData, echo=FALSE, results='hide'}
del <- data.frame(war=rep(c("Gulf","Bosnia"),each=9),
                  time=c(28.0,20.0,26.5,10.6,9.1,35.2,29.1,41.2,27.5,
                         15.1,6.4,5.0,11.4,6.5,6.5,3.0,7.0,3.5))
```

```{r DeliveriesCode, echo=FALSE, results='hide'}
(del.lev <- levenesTest(time~war,data=del) )
( del.t <- t.test(time~war,data=del,var.equal=TRUE,alt="less") ) # mu=0 is a default
```

1. &alpha; = 0.05
1. H<sub>A</sub>: &mu;<sub>b</sub>-&mu;<sub>g</sub> &lt; 0 and H<sub>0</sub>: &mu;<sub>b</sub>-&mu;<sub>g</sub> = 0, where &mu; is the mean time to deliver ALL shipments, b is for Bosnia, and g is for Persian Gulf War.
1. 2-sample t-test because (i) two groups/populations are considered (Bosnia and Persian Gulf), (ii) a quantitative variable (delivery time) was recorded, and (iii) the individuals in the groups are independent (there is no known connection between all deliveries to the two wars).
1. An observational study without clear randomization of the two samples.
1. The assumptions are met because (i) the samples are independent (as described above), (ii) n<sub>b</sub>+n<sub>g</sub> = 9+9 = 18 &gt; 15 and the two sample distributions (see histograms below) are not obviously strongly skewed (also told to assume that the distributions are not strongly skewed), and (iii) the variances appear to be equal (Levene's p-value = `r  kPvalue(del.lev$"Pr(>F)"[1],include.p=FALSE)` &gt; &alpha;).
1. x&#772;<sub>b</sub>-x&#772;<sub>g</sub> = `r formatC(del.t$estimate[1],format="f",digits=2)`-`r formatC(del.t$estimate[2],format="f",digits=2)` = `r formatC(del.t$estimate[1]-del.t$estimate[2],format="f",digits=2)`.
1. The test statistic is t = `r formatC(del.t$statistic,format="f",digits=3)` with `r formatC(del.t$parameter,format="f",digits=0)` df.
1. The p-value = `r kPvalue(del.t$p.value,include.p=FALSE,latex=FALSE)`.
1. The H<sub>0</sub> is rejected because the p-value &lt; &alpha;.
1. The mean delivery time was significantly lower in Bosnia than in the Persian Gulf War. Thus, the new "just-in-time" mentality for deliveries appears to have resulted in quicker delivery times.
1. I am 95% confident that the mean delivery time for Bosnia was more than `r formatC(-1*del.t$conf.int[2],format="f",digits=1)` days faster than for the Persian Gulf War. This further supports that the mean delivery time was faster with the new system.


#### R Code and Results
```{r eval=FALSE}
del <- read.csv("deliveries.csv")
```
```{r warning=FALSE}
ggplot(data=del,mapping=aes(x=time)) +
  geom_histogram(binwidth=5,boundary=0,color="black",fill="lightgray") +
  labs(x="Time for Delivery",y="Frequency of Deliveries") +
  scale_y_continuous(expand=expansion(mult=c(0,0.05))) +
  theme_NCStats() +
  facet_wrap(vars(war))

<<DeliveriesCode>>
```
