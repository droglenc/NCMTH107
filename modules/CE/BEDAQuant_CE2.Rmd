---
layout: page
title: Additional Exercises
subtitle: Bivariate EDA - Quantitative
author: Derek H. Ogle
css: "/css/modules.css"
output:
  html_document:
    self_contained: false
    lib_dir: zlibs
---

```{r echo=FALSE, eval=FALSE}
# Renders an appropriate HTML file for the webpage
setwd("C:/aaaWork/Web/GitHub/NCMTH107/modules/CE/")
source("../../rhelpers/rhelpers.R")
modHTML("BEDAQuant_CE2")
```

```{r echo=FALSE, results='hide', message=FALSE}
source("../../rhelpers/knitr_setup.R")
library(dplyr)
library(ggplot2)
library(NCStats)
```

&nbsp;

1. **General Understandings**
    1. [Associations II](#associations-ii)
1. **Applications**
    1. [Plastic Waste and GDP](#plastic-waste-and-gdp)
    1. [Rates of Drinking Alcohol](#rates-of-drinking-alcohol)
    1. [Metals in Topsoil](#metals-in-topsoil)
    1. [Highway and City MPG](#highway-and-city-mpg)

&nbsp;

----

# General Understandings
## Associations II
For each situation below, identify (a) the response variable (if possible) and (b) whether you would expect a positive, negative, or no (neutral) association between the pair of variables.  Explain your reasoning for both answers.

1. Proportion of population with a post-secondary education and proportion of the population that have been incarcerated.
1. Temperature and sales of ice cream.
1. Hours spent exercising and percent body fat.
1. Average annual amount of snowfall and proportion that support conceal-and-carry gun laws (recorded for states from across the U.S.)
1. Husbands' and wife's ages.
1. Golfers' putting success and distance of the putt.

----

&nbsp;

# Applications
## Plastic Waste and GDP
Use the figure below to perform a bivariate EDA between the per capita plastic waste generation rate (kg of plastic waste per person per day) and gross domestic product (GDP) per capita (in 2011 international dollars) measured for 148 countries in 2010.[^plasticsdata]

```{r echo=FALSE,warning=FALSE,fig.width=3.5,fig.height=4.5}
plastics <- read.csv("plastics1.csv") %>%
  janitor::clean_names() %>%
  mutate(year=as.numeric(year)) %>%
  rename(waste=4,gdp=5) %>%
  filter(year==2010,!is.na(waste),!is.na(gdp))
contcodes <- read.csv("https://datahub.io/JohnSnowLabs/country-and-continent-codes-list/r/country-and-continent-codes-list-csv.csv")
plastics <- left_join(plastics,contcodes,by=c("code"="Three_Letter_Country_Code"))

ggplot(data=plastics,mapping=aes(x=gdp,y=waste)) +
  geom_point(aes(fill=Continent_Name),pch=21,color="black",size=2) +
  scale_x_continuous(labels=scales::dollar) +
  ggpubr::stat_cor(aes(label=..r.label..),r.digits=3,cor.coef.name="r",
                   label.x.npc=0.8) +
  labs(x="GDP per Capita",y="Plastic Waste (kg per person per day)",
       fill="") +
  theme_NCStats() +
  theme(legend.position="bottom",aspect.ratio=1)
```

----

## Rates of Drinking Alcohol
Use the figure below to perform a bivariate EDA between the percents of men and women who drank alcohol in the last year as recorded for 148 countries in 2010.[^plasticsdata]

```{r echo=FALSE,warning=FALSE,fig.width=3.5,fig.height=4.5}
drink <- read.csv("drinking.csv") %>%
  janitor::clean_names() %>%
  mutate(year=as.numeric(year)) %>%
  rename(males=4,females=5) %>%
  filter(year==2010,!is.na(males),!is.na(females)) %>%
  left_join(contcodes,by=c("code"="Three_Letter_Country_Code"))

ggplot(data=drink,mapping=aes(x=females,y=males)) +
  geom_point(aes(fill=Continent_Name),pch=21,color="black",size=2) +
  scale_x_continuous(labels=scales::percent_format(scale=1)) +
  scale_y_continuous(labels=scales::percent_format(scale=1)) +
  coord_cartesian(xlim=c(0,100),ylim=c(0,100)) +
  geom_abline(slope=1,intercept=0,color="lightgray",linetype="dashed") +
  ggpubr::stat_cor(aes(label=..r.label..),r.digits=3,cor.coef.name="r") +
  labs(x="% Females Drank Alcohol in Last Year",
       y="% Males Drank Alcohol in Last Year)",
       fill="") +
  theme_NCStats() +
  theme(legend.position="bottom",aspect.ratio=1)
```

----

## Metals in Topsoil
The concentration of cadmium and copper in the topsoil of 115 15mX15m plots along the river Meuse in the village Stein in New Zealand was recorded by van Rijn and Rikken. Use the scatterplot below to describe the bivariate relationship between these two variables.

```{r ScatSoil, echo=FALSE,fig.height=3.5,fig.width=3.5}
data(meuse,package="sp")
ggplot(data=meuse,mapping=aes(x=cadmium,y=copper)) +
  geom_point(pch=21,color="black",fill="lightgray",size=2) +
  ggpubr::stat_cor(aes(label=..r.label..),r.digits=3,cor.coef.name="r") +
  labs(x="Cadmium (ppm)",y="Copper (ppm)") +
  theme_NCStats()
```

----

## Highway and City MPG
Researchers at Chevrolet attempted to determine the relationship between gas mileage (MPG) of Luminas in the city (CITY) and on the highway (HIGHWAY). Their results are shown below. Use this information to write a brief description of this bivariate relationship.

```{r ScatLumina, echo=FALSE,fig.height=3.5,fig.width=3.5}
lum <- data.frame(HMPG=c(30,29,29,29,28,28,27,27,27,26,26,26,26,26,25,25,25,24,24,24,24,23,23,23,22,22,22,22,21,21,21,20,20,20),
                  CMPG=c(26,26,25,22,23,25,24,23,21,23,22,21,20,19,19,20,21,22,21,19,17,18,19,20,19,18,17,16,17,18,19,18,17,16))
ggplot(data=lum,mapping=aes(x=HMPG,y=CMPG)) +
  geom_point(pch=21,color="black",fill="lightgray",size=2) +
  ggpubr::stat_cor(aes(label=..r.label..),r.digits=3,cor.coef.name="r") +
  labs(x="Highway MPG",y="City MPG") +
  theme_NCStats()
```

&nbsp;

[^plasticsdata]: These data are originally from [this website](https://ourworldindata.org/grapher/per-capita-plastic-waste-vs-gdp-per-capita).

[^drinkingdata]: These data are originally from [this website](https://ourworldindata.org/grapher/males-vs-females-who-drank-alcohol-in-last-year).
