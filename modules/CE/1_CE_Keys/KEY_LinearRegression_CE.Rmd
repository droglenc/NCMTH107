---
title: "Answer Key"
subtitle: "Linear Regression CE"
author: Derek H. Ogle
layout: page
css: "/css/modules.css"
output:
  html_document:
    fig_height: 3.5
    fig_width: 3.5
    self_contained: false
---

```{r echo=FALSE, eval=FALSE}
## Renders an appropriate HTML file and moves to CE directory
source("modules/CE/1_CE_Keys/zzz_modHTML_CEKeys.R")
modHTML_CEKeys("KEY_LinearRegression_CE")
```

```{r echo=FALSE, results='hide', message=FALSE}
library(NCStats)
source("../../../rhelpers/knitr_setup.R")
library(captioner)
figs <- captioner(prefix="Figure")
figs(name="IBI1","Fitted-line plot for the relatinoship between IBI scores and the percentage of imperious surface for 14 locations in Washington.")
figs(name="VisionFitPlot","Fitted line plot for the relationship between maximum distance to see a sign and the age of a driver.")
figs(name="FishingFitPlot","Fitted line plot for the relationship between fishing pressure and number of counted cars on Wyoming resrvoirs.")
figs(name="Cafe1","Fitted-line plot for the relatinoship between number of coffees sold and the maximum daily temperature for the college cafe.")
```

----

## Equation of the Line I

1. **Dishwasher Example**
    1. response - Height of suds (mm)
    1. explanatory - Amount of soap (g)
    1. slope is 12.4
    1. intercept is -20.2
    1. For each additional gram of soap, the height of suds increases by 12.4 mm, on average.
    1. For 0 grams of soap, the height of suds is -20.2 mm, on average.  [*This is an extrapolation.*]
    1. Ask to predict height of suds for an amount of soap between 3.5 and 8.0 grams.  Example ... "What is the predicted height of suds for 5 g of soap?"  Answer ... -20.2+12.4*5=41.8 mm.
    1. Ask to predict height of suds for an amount of soap not between 3.5 and 8.0 grams.  Example ... "What is the predicted height of suds for 10 g of soap?"
1. **Livestock Food Example**
    1. response - Costs
    1. explanatory - Livestock food mix in tons
    1. Slope is 190.
    1. Intercept is 12075
    1. For each additional ton of the food mix, the cost increases by $190, on average.
    1. For 0 tons of the food mix, the costs are $12075, on average. [*This may be considered as "start-up" costs.*]
    1. Ask to predict costs for food mix amounts between 36.5 and 42 tons.  Example ... "What is the cost to make 40 tons of the mix?"  Answer ... 190*40+12075 = $19675.
    1. Ask to predict costs for food mix amounts not between 36.5 and 42 tons.  Example ... "What is the cost to make 70 tons of the mix?"

----

<div class="alert alert-warning">
<strong>Note:</strong> In the applied questions below ...
<ul>
<li>The words "response", "explanatory", "y", and "x" are not used at all. These words should be replaced with the actual variable names used in the problem.</li>
<li>The x-axis (explanatory) variable is <strong>increased</strong> by 1 unit when describing the slope. If the slope is positive then the y-axis (response) variable increases by the slope amount for each 1 unit increase of the explanatory variable. If the slope is negative then the y-axis (response) variable decreases by the slope amount (with the negative sign removed) for each 1 unit increase of the explanatory variable.</li>
<li>Interpret the y-intercept value even if it does not make sense, which will happen often as the y-intercept is often an extreme extrapolation.</li>
<li>When computing the residual, make sure to do the observed y-axis (response) value minus the predicted y-axis (response) value. About half the time this will result in a negative value. That is okay, it just means that the observed value was less than the predicted value (i.e., the observed point was below the best-fit line).</li>
<li>The words "proportion of variability explained" <strong>always</strong> imply using r<sup>2</sup> as the answer.</li>
<li>The correlation coefficient is always the value of r. If you compute r by taking the square root of r<sup>2</sup> then remember to put a negative sign on it if the slope (i.e., direction or association) is negative (your calculator will always return a positive value).</li>
<li>When assessing whether anything "concerns" you about the regression then you should address whether the form looks linear and if there is homoscedasticty. Non-linear forms will look obviously curved, heteroscedastic forms will look like a funnel (usually from narrow on the left to wider on the right). If you do not see a curve or a funnel, then explicitly say that you do not have any concerns about the lack of linearity or homoscedasticity.</li>
</ul>
</div>


## Beach Sand
```{r echo=FALSE}
m <- 0.053
b <- 0.159
rsq <- 0.912
```

1. The equation of the best-fit line is SAND = `r b`+`r m`*ANGLE
1. For each 1 degree increase in beach angle, the median sand diameter increases by `r m` mm, on average.
1. If there is 0 beach angle, then the median sand diameter is `r b` mm, on average.
1. This prediction should not be computed, because 15 degrees of beach angle is outside of the domain of the data used to define the relationship (i.e., this is an extrapolation).
1. The predicted median sand diameter for a beach angle of 4 degrees is `r formatC(b+m*4,format="f",digits=3)` mm.
1. The residual for an observed median sand diameter of 0.2 mm and beach angle of 5 degrees is `r formatC(0.2-(b+m*5),format="f",digits=3)` mm.
1. The correlation coefficient between median sand diameter and beach angle is `r formatC(sqrt(rsq),format="f",digits=3)`.
1. The proportion of variability in median sand diameter that is explained by knowing the angle of the beach is `r formatC(rsq,format="f",digits=3)`.
1. I would expect the median sand diameter to increase by four slopes or `r formatC(4*m,format="f",digits=3)` mm, on average, if the beach angle increased by 4 degrees.
1. The relationship between median sand diameter and beach angle appears to be nonlinear.

----


## Everest Temperatures
```{r echo=FALSE}
m <- -0.0059
b <- 29.79
rsq <- 0.923
```

1. The equation of the best-fit line is AIRTEMP = `r b`+`r m`*ALTLAPSERATE
1. If the altitude lapse rate is 0, then the mean air temperature is `r b`<sup>o</sup>C, on average.
1. For each 1 degree increase in altitude lapse rate, the mean air temperature decreases by `r -1*m`<sup>o</sup>C, on average.
1. The predicted mean air temperature for an altitude lapse rate of 4000 <sup>o</sup>C/km is `r formatC(b+m*4000,format="f",digits=2)`<sup>o</sup>C.
1. The residual for an observed mean air temperature of 0<sup>o</sup>C and altitude lapse rate of 3500<sup>o</sup>C/km is `r formatC(0-(b+m*3500),format="f",digits=2)`<sup>o</sup>C.
1. The correlation coefficient between mean air temperature and altitude lapse rate is `r formatC(sqrt(rsq),format="f",digits=3)`.
1. I would expect the mean air temperature to decrease by 1000 slopes or `r formatC(-1000*m,format="f",digits=3)` mm, on average, if the altitude lapse rate increased by 1000<sup>o</sup>C/km.
1. This prediction should not be computed, because 1000<sup>o</sup>C/km of altitude lapse rate is outside of the domain of the data used to define the relationship (i.e., this is an extrapolation).
1. The proportion of variability in mean air temperature that is explained by knowing the altitude lapse rate is `r formatC(rsq,format="f",digits=3)`.
1. I have no concerns as the relationship between mean air temperature and altitude lapse rate appears to be linear and homoscedastic.

----

## Urban Runoff

```{r echo=FALSE}
d <- data.frame(imp=c(60,43,43,34,27,25,21,18,11,8,8,8,7,7,5,4,2),
                IBI=c(9,11,13,23,31,31,21,23,27,37,39,29,31,43,33,35,37))
```
```{r IBICalc,echo=FALSE, results="hide"}
( lm1 <- lm(IBI~imp,data=d) )
rSquared(lm1)
```
```{r echo=FALSE}
cfs <- coef(lm1)
```

1. The equation of the best-fit line is IBI=`r formatC(cfs[1],format="f",digits=4)`-`r formatC(-cfs[2],format="f",digits=4)`*imp.
1. If the percent of impervious surface increases by 1%, then the IBI score decreases by `r formatC(-cfs[2],format="f",digits=2)`, on average.
1. If the percent of impervious surface is 0, then the IBI score is `r formatC(cfs[1],format="f",digits=1)`, on average.
1. This question is an extrapolation and should not be answered (`r figs("IBI1",display="cite")`).
1. The IBI score is predicted to be `r formatC(predict(lm1,data.frame(imp=20)),format="f",digits=1)` when the percent of impervious surface is 20%.
1. The residual for an observed IBI score of 20 and a percent of impervious surface of 30% is `r formatC(20-predict(lm1,data.frame(imp=30)),format="f",digits=1)`.
1. The IBI will change by -30 slopes or `r formatC(-30*cfs[2],format="f",digits=4)` if the percentage of impervious surface is decreased by 30%. In other words the IBI will increase by `r formatC(-30*cfs[2],format="f",digits=4)` units.
1. The correlation coefficient between IBI score and percent of impervious surface is `r formatC(-sqrt(rSquared(lm1)),format="f",digits=2)`.
1. The proportion of variability in IBI scores that is explained by knowing the percent of impervious surface is `r formatC(rSquared(lm1),format="f",digits=2)`.
1. There appears to be homoscedasticity, but there is slight evidence of a curve suggesting that the relationship is nonlinear (`r figs("IBI1",display="cite")`).

```{r IBIPlot, echo=FALSE, par1=TRUE}
fitPlot(lm1,pch=21,bg="gray70",xlab="Percentage of Impervious Surface")
```

`r figs("IBI1")`

R Appendix.
```{r eval=FALSE, prompt=FALSE}
d <- read.csv("runoff.csv")
<<IBICalc>>
<<IBIPlot>>
```

----

## Sign Legibility and Age
```{r echo=FALSE}
d <- read.csv("https://github.com/droglenc/NCData/raw/master/vision.csv")
```
```{r VisionCalc, echo=FALSE, results='hide'}
( lm1 <- lm(distance~age,data=d) )
predict(lm1,data.frame(age=40))
410-predict(lm1,data.frame(age=50))
rSquared(lm1)
corr(~distance+age,data=d)
```

1. The response variable is maximum distance to see the sign. [*Note that distance to see the sign depends on age and distance to see the sign is what is predicted or explained in the ensuing questions.*]
1. The explanatory variable is age.
1. The best-fit line is distance=`r formatC(coef(lm1)[2],format="f",digits=2)`*age+`r formatC(coef(lm1)[1],format="f",digits=1)`.
1. The slope indicates that for every increase of one year in age the maximum distance to see the sign will decrease by `r formatC(-1*coef(lm1)[2],format="f",digits=2)` ft, on average.
1. The intercept indicates that if the age of the driver was zero, then the maximum distance to see the sign would be `r formatC(coef(lm1)[1],format="f",digits=1)` ft, on average.
1. The predicted maximum distance to see the sign for a 40-year-old driver is `r formatC(predict(lm1,data.frame(age=40)),format="f",digits=1)` ft.
1. This prediction should not be made as an age of 90 is outside the observed results for this variable (`r figs("VisionFitPlot",display="cite")`) and is, thus, an extrapolation.
1. The residual for an individual that is 50-years-old and had a maximum distance to see the sign of 410 ft is `r formatC(410-predict(lm1,data.frame(age=50)),format="f",digits=1)` ft. Thus, this individual would have a shorter maximum distance to see the sign than an average 50-year-old.
1. The correlation coefficient between age of the driver and maximum distance to see the sign is `r formatC(corr(~age+distance,data=d),format="f",digits=2)`.
1. The proportion of variability in maximum distance to see the sign that is explained by knowing the age of the driver is `r formatC(rSquared(lm1),format="f",digits=2)`.
1. If the age of the driver increased by ten years then the predicted maximum distance to see the sign would decrease by ten slopes or `r formatC(-10*coef(lm1)[2],format="f",digits=2)` ft.
1. I don't have any strong concerns, though the data look very slightly nonlinear and very slightly heteroscedastic (`r figs("VisionFitPlot",display="cite")`).

```{r VisionFitPlot, echo=FALSE, par1=TRUE}
fitPlot(lm1,pch=21,bg="gray70",
        ylab="Max. Distance to See Sign (ft)",
        xlab="Age of the Driver")
```

`r figs("VisionFitPlot")`

R Appendix
```{r eval=FALSE, prompt=FALSE}
setwd('C:/aaaWork/Books/IntroStats/HW/')
d <- read.csv("vision.csv")
<<VisionCalc>>
<<VisionFitPlot>>
```

----

## Equation of the Line II

1. **Grey Kangaroo Example**
    1. response - Nasal width (mm x10)
    1. explanatory - Nasal length (mm x10)
    1. The slope is 0.2876.
    1. The intercept is 46.451.
    1. For every 1 unit (10 mm) increase in nasal length, the nasal width increases by 0.2876 units (i.e., 2.876 mm), on average.
    1. The nasal width when the nasal length is 0 mm is 46.451 units (i.e., 464.51 mm), on average.
    1. Ask to predict the nasal width when the nasal length (x10) is between 450 and 900.  Example ... "What is the predicted nasal width when the nasal length (x10) is 600 (i.e., 60 mm)?"  Answer ... Y=0.2876*600+46.451=219.01 (or 21.9 mm).
    1. Ask to predict the nasal width when the nasal length (x10) is not between 450 and 900.  Example ... "What is the predicted nasal width when the nasal length (x10) is 250 (i.e., 25 mm)?"

----

## Estimating Fishing Pressure
```{r echo=FALSE}
d <- read.csv("https://github.com/droglenc/NCData/raw/master/AlcovaRes.csv")
```
```{r FishingCalc, echo=FALSE, results='hide'}
wd <- filterD(d,day.type=="wday")
( lm1 <- lm(pressure~index,data=wd) )
predict(lm1,data.frame(index=5))
5100-predict(lm1,data.frame(index=8))
rSquared(lm1)
corr(~pressure+index,data=wd)
```

1. The response variable is fishing pressure.
1. The explanatory variable is index count.
1. The best-fit line is pressure=`r formatC(coef(lm1)[2],format="f",digits=1)`*index+`r formatC(coef(lm1)[1],format="f",digits=1)`.
1. The slope indicates that for every increase of one vehicle in the index count the pressure will increase by `r formatC(coef(lm1)[2],format="f",digits=1)` angler-hours, on average.
1. The intercept indicates that if the index count was zero, then the pressure would be `r formatC(coef(lm1)[1],format="f",digits=1)` angler-hours, on average.
1. This prediction should not be made as an index count of 20 is outside the observed results for this variable (`r figs("FishingFitPlot",display="cite")`) and is, thus, an extrapolation.
1. The predicted amount of fishing pressure for an index count of five vehicles is `r formatC(predict(lm1,data.frame(index=5)),format="f",digits=1)` angler-hours.
1. The residual for an individual with a fishing pressure of 5100 and an index count of eight vehicles is `r formatC(5100-predict(lm1,data.frame(index=8)),format="f",digits=1)` angler-hours.
1. The correlation between fishing pressure and index count is `r formatC(corr(~pressure+index,data=wd),format="f",digits=2)`.
1. The proportion of variability in fishing pressure that is explained by knowing index count is `r formatC(rSquared(lm1),format="f",digits=2)`.
1. If the index count is under-estimated by two vehicles, then the pressure value will be under-predicted by two slopes or `r formatC(2*coef(lm1)[2],format="f",digits=1)` angler-hours
1. The data appears to be roughly linear but this is difficult to tell based on the wide scatter of points.  My concern, though, is that the data appear to be somewhat heteroscedastic (`r figs("FishingFitPlot",display="cite")`).

```{r FishingFitPlot, echo=FALSE, par1=TRUE}
fitPlot(lm1,pch=21,bg="gray70",
        ylab="Fishing Pressure",xlab="Index Count")
```

`r figs("FishingFitPlot")`

R Appendix
```{r eval=FALSE, prompt=FALSE}
setwd('C:/aaaWork/Books/IntroStats/HW/')
d <- read.csv("AlcovaRes.csv")
<<FishingCalc>>
<<FishingFitPlot>>
```

----

## Cafe Sales

```{r echo=FALSE}
d <- read.csv("cafedata.csv")
```
```{r CafeCalc,echo=FALSE,results="hide"}
( lm1 <- lm(coffee.sold~max.temp,data=d) )
rSquared(lm1)
```
```{r echo=FALSE}
cfs <- coef(lm1)
```

1. The equation of the best-fit line is COFFEESOLD = `r formatC(cfs[1],format="f",digits=4)`-`r formatC(-cfs[2],format="f",digits=4)`*MAXTEMP
1. For each additional degree of maximum temperature, the number of coffees sold decreases by `r formatC(-cfs[2],format="f",digits=2)`, on average.
1. If the maximum temperature is 0F, then the number of coffees sold is `r formatC(cfs[1],format="f",digits=1)`, on average.
1. The predicted number of coffees sold if the maximum temperature if 40F is `r formatC(predict(lm1,data.frame(max.temp=40)),format="f",digits=1)`.
1. This question is an extrapolation and should not be answered.
1. The residual for an observation of 30 coffees sold when the maximum temperature was 40F is `r formatC(30-predict(lm1,data.frame(max.temp=40)),format="f",digits=1)`.
1. The correlation coefficient between the number of coffees sold and the maximum temperature is `r formatC(-sqrt(rSquared(lm1)),format="f",digits=2)` (this should be interpreted cautiously as the relationship is slightly nonlinear; `r figs("Cafe1",display="cite")`).
1. The proportion of variability in number of coffees sold explained by knowing the maximum temperature is `r formatC(rSquared(lm1),format="f",digits=2)`.
1. The relationship appears to be homoscedastic, but nonlinear (`r figs("Cafe1",display="cite")`).

```{r CafePlot,echo=FALSE,par1=TRUE}
fitPlot(lm1,pch=21,bg="gray70",
        ylab="Number of Coffees Sold",xlab="Maximum Temperature")
```

`r figs("Cafe1")`

R Appendix.
```{r eval=FALSE, prompt=FALSE}
d <- read.csv("cafedata.csv")
<<CafeCalc>>
<<CafePlot>>
```

----
