---
title: "Answer Key"
subtitle: "1-Sample t CE"
author: Derek H. Ogle
layout: page
css: "/css/modules.css"
output:
  html_document:
    fig_height: 3.5
    fig_width: 3.5
    self_contained: false
---

```{r echo=FALSE, eval=FALSE}
## Renders an appropriate HTML file and moves to CE directory
source("modules/CE/1_CE_Keys/zzz_modHTML_CEKeys.R")
modHTML_CEKeys("KEY_1Samplet_CE")
```

```{r echo=FALSE, results='hide', message=FALSE}
library(NCStats)
source("../../../rhelpers/knitr_setup.R")
library(captioner)
tbls <- captioner(prefix="Table")
figs <- captioner(prefix="Figure")
tbls(name="pH","Results from the one-sample t-test for testing that the pH is less than 5.6.")
tbls(name="Ozone","Results from the one-sample t-test for testing that the mean thickness of the ozone layer is different than 300 Dobson units.")
tbls(name="FC","Results from the one-sample t-test for testing that the mean CFU per 100 ml of lake water is greater than 150 CFU per 100 ml.")
figs(name="FChist","Histogram of the CFU per 100 ml in samples of lake water.")
```

----

## P-Value Calculations and Decisions I

<ol>
<li>Reject H<sub>0</sub> because p-value=`r formatC(2*distrib((11.2-14)/(6.1/sqrt(25)),df=24,distrib="t"),format="f",digits=4)`<&alpha;.</li>
```{r echo=FALSE, par1a=TRUE}
distrib((11.2-14)/(6.1/sqrt(25)),df=24,distrib="t")
```

<li>Reject H<sub>0</sub> because p-value=`r formatC(distrib((79.5-75)/(11.7/sqrt(50)),df=49,lower.tail=FALSE,distrib="t"),format="f",digits=4)`<&alpha;.</li>
```{r echo=FALSE, par1a=TRUE}
distrib((79.5-75)/(11.7/sqrt(50)),df=49,lower.tail=FALSE,distrib="t")
```
</ol>

----

## Confidence Interval Calculations I

<ol>
<li>See below.</li>
<ol type="a">
<li>C=0.95</li>
<li>Interval</li>
```{r echo=FALSE, results='hide', fig.show='hide'}
tstar <- distrib(0.975,df=24,type="q",distrib="t")
ci <- 11.2+c(-1,1)*tstar*6.1/sqrt(25)
```
<li>t*=&plusmn;`r formatC(tstar,format="f",digits=3)`.</li>
```{r echo=FALSE, par1a=TRUE}
distrib(0.975,df=24,type="q",distrib="t")
```
<li>(`r formatC(ci[1],format="f",digits=1)`,`r formatC(ci[2],format="f",digits=1)`).</li>
<li>I am 95% confident that the true population mean is between `r formatC(ci[1],format="f",digits=1)` and `r formatC(ci[2],format="f",digits=1)`.</li>
</ol>

<li>See below.</li>
<ol type="a">
<li>C=0.90</li>
<li>Lower bound</li>
```{r echo=FALSE, results='hide', fig.show='hide'}
tstar <- distrib(0.9,df=49,type="q",lower.tail=FALSE,distrib="t")
lcb <- 79.5+tstar*11.7/sqrt(50)
```
<li>t*=`r formatC(tstar,format="f",digits=3)`.</li>
```{r echo=FALSE, par1a=TRUE}
distrib(0.9,df=49,type="q",lower.tail=FALSE,distrib="t")
```
<li>`r formatC(lcb,format="f",digits=1)`.</li>
<li>I am 90% confident that the true population mean is greater than `r formatC(lcb,format="f",digits=1)`.</li>
</ol>
</ol>

----

## Fecal Coliform Counts I

```{r CFU1Calc, echo=FALSE, results='hide', fig.show='hide'}
xbar <- 168.19; s <- 22.20; n <- 25
se <- s/sqrt(n)
t <- (xbar-178)/se
df <- n-1
pv <- 2*distrib(t,distrib="t",df=df)
tstar <- distrib(0.975,type="q",distrib="t",df=df)
ci <- xbar+c(-1,1)*tstar*se
```

<ol>
<li>&alpha;=0.05.</li>
<li>H<sub>A</sub>: &mu;&ne;178 and H<sub>0</sub>: &mu;=178, where &mu; is the mean number of CFU per 100 ml in ALL samples from this lake on this date.</li>
<li>1-sample t-test because (i) one group or population (this lake) was sampled, (ii) a quantitative variable (number of CFU per 100 ml) was recorded, and (iii) &sigma; is not known.</li>
<li>An observational study without clear randomization of 25 water samples.</li>
<li>The assumptions are met because (i) &sigma; is not known and (ii) n=25&ge;15 and the histogram (given in question) is not strongly skewed.</li>
<li>x&#772;=`r xbar` CFU per 100 ml.</li>
<li>t=`r formatC(t,format="f",digits=4)` with `r df` df.</li>
<li>p-value=`r kPvalue(pv,include.p=FALSE,latex=FALSE)`.</li>
<li>Reject H<sub>0</sub> because the p-value<&alpha;.</li>
<li>It appears that the mean CFU per ALL 100 ml of water sampled from this lake on this date is less than what the computer model predicted.</li>
<li>One can be 95% confident that the mean CFU per ALL 100 ml of water sampled from this lake on this date is between `r formatC(ci[1],format="f",digits=0)` and  `r formatC(ci[2],format="f",digits=0)`.</li>
</ol>

R Appendix.
```{r eval=FALSE, prompt=FALSE}
<<CFU1Calc>>
```

----

## Fecal Coliform Counts II

```{r}
df <- read.csv("../FecalColiform.csv")
t.test(df$CFU,mu=178,alt="two.sided",conf.level=0.95)
```

----

## Acid Rain in Shenandoah National Park
```{r echo=FALSE}
ph <- read.csv("https://github.com/droglenc/NCData/raw/master/pHlevels.csv")
```
```{r pHCalc, echo=FALSE, results='hide'}
( ph.t <- t.test(ph$pH,mu=5.6,alt="less",conf.level=0.99) )
```

<ol>
  <li> &alpha;=0.01.</li>
  <li> H<sub>A</sub>:&mu;<5.6 and H<sub>O</sub>:&mu;=5.6, where &mu; is the mean pH for all rainwater collections at the Big Meadows Station in the Shenandoah National Park, VA.</li>
  <li> A one-sample t-test is required because quantitative variable (pH) was measured on individuals from one group or population (all rainwater collections at Big Meadows Station), &sigma; is UNknown, and the population mean is being compared to a specific value in the hull hypothesis.</li>
  <li> An observational study without obvious randomization was used.</li>
  <li> The assumptions are met because &sigma; is unknown and m=`r formatC(ph.t$parameter+1,format="f",digits=0)`&ge;40. Thus, the sampling distribution of the test statistic should follow a t-distribution.</li>
  <li> The statistic is x&#772;=`r formatC(ph.t$estimate,format="f",digits=3)` (`r tbls("pH",display="cite")`).</li>

`r tbls("pH")`

```{r echo=FALSE,background="white"}
kHtest(ph.t)
```

  <li> The test statistic is t=`r formatC(ph.t$statistic,format="f",digits=3)` with `r formatC(ph.t$parameter,format="f",digits=0)` df (`r tbls("pH",display="cite")`).</li>
  <li> The p-value is `r kPvalue(ph.t$p.value,include.p=FALSE,latex=FALSE)` (`r tbls("pH",display="cite")`).</li>
  <li> The H<sub>O</sub> is rejected because the p-value<&alpha;.</li>
  <li> The mean pH appears to be significantly lower than 5.6 and, thus, indicates acid rain at this site.</li>
  <li> A 99% upper confidence bound is required. Thus, one is 99% confident that the mean pH level is less than `r formatC(ph.t$conf.int[2],format="f",digits=2)` (`r tbls("pH",display="cite")`).</li>
</ol>

R Appendix.
```{r eval=FALSE, prompt=FALSE}
setwd('C:/aaaWork/Books/IntroStats/HW/')
ph <- read.csv("pHlevels.csv")
<<pHCalc>>
```

----

## P-Value Calculations and Decisions II

<ol>
<li>Do Not Reject H<sub>0</sub> because p-value=`r formatC(distrib((858-880)/(92/sqrt(80)),df=79,distrib="t"),format="f",digits=4)`>&alpha;.</li>
```{r echo=FALSE, par1a=TRUE}
distrib((858-880)/(92/sqrt(80)),df=79,distrib="t")
```

<li>Do Not Reject H<sub>0</sub> because p-value=`r formatC(2*distrib((1730-1500)/(790/sqrt(40)),df=39,lower.tail=FALSE,distrib="t"),format="f",digits=4)`>&alpha;.</li>
```{r echo=FALSE, par1a=TRUE}
distrib((1730-1500)/(790/sqrt(40)),df=39,lower.tail=FALSE,distrib="t")
```
</ol>

----

## Confidence Interval Calculations II

<ol>
<li>See below.</li>
<ol type="a">
<li>C=0.99</li>
<li>Upper bound</li>
```{r echo=FALSE, results='hide', fig.show='hide'}
tstar <- distrib(0.99,df=79,type="q",distrib="t")
ucb <- 858+tstar*92/sqrt(80)
```
<li>t*=`r formatC(tstar,format="f",digits=3)`.</li>
```{r echo=FALSE, par1a=TRUE}
distrib(0.99,df=79,type="q",distrib="t")
```
<li>`r formatC(ucb,format="f",digits=1)`.</li>
<li>I am 99% confident that the true population mean is less than `r formatC(ucb,format="f",digits=1)`.</li>
</ol>

<li>See below.</li>
<ol type="a">
<li>C=0.95</li>
<li>Interval</li>
```{r echo=FALSE, results='hide', fig.show='hide'}
tstar <- distrib(0.975,df=39,type="q",distrib="t")
ci <- 1730+c(-1,1)*tstar*790/sqrt(40)
```
<li>t*=&plusmn;`r formatC(tstar,format="f",digits=3)`.</li>
```{r echo=FALSE, par1a=TRUE}
distrib(0.975,df=39,type="q",distrib="t")
```
<li>(`r formatC(ci[1],format="f",digits=1)`,`r formatC(ci[2],format="f",digits=1)`).</li>
<li>I am 95% confident that the true population mean is between `r formatC(ci[1],format="f",digits=1)` and `r formatC(ci[2],format="f",digits=1)`.</li>
</ol>
</ol>

----

## Increased Civility in Nation-States?
```{r KillingsCalc, echo=FALSE, results='hide', fig.show='hide'}
xbar <- 3292.8; s <- 4814.5; n <- 75
se <- s/sqrt(n)
t <- (xbar-4104)/se
df <- n-1
pv <- distrib(t,distrib="t",df=df)
ucb <- xbar+distrib(0.95,type="q",distrib="t",df=df)*se
```

<ol>
<li>&alpha;=0.05.</li>
<li>H<sub>A</sub>: &mu;<4104 and H<sub>0</sub>: &mu;=4104, where &mu; is the mean number of citizens killed by ALL nation-states.</li>
<li>1-sample t-test because (i) one group or population (all nation-states) was sampled, (ii) a quantitative variable (number of killings) was recorded, and (iii) &sigma; is not known.</li>
<li>An observational study with clear randomization of 75 countries.</li>
<li>The assumptions are met because (i) &sigma; is not known and (ii) n=75&ge;40.</li>
<li>x&#772;=`r xbar` killings.</li>
<li>t=`r formatC(t,format="f",digits=4)` with `r df` df.</li>
<li>p-value=`r kPvalue(pv,include.p=FALSE,latex=FALSE)`.</li>
<li>Do not reject H<sub>0</sub> because the p-value>&alpha;.</li>
<li>It appears that the number of killings for recent times is NOT significanlty lower than it was as determined from 19th century history books.</li>
<li>Strictly not needed, but one could say that they were 95% confident that the number of killings in recent years for ALL nation-states is less than `r formatC(ucb,format="f",digits=0)` (which contains the value in the H<sub>0</sub>).</li>
</ol>

R Appendix.
```{r eval=FALSE, prompt=FALSE}
<<KillingsCalc>>
```

----

## Sea Level Rise Rate

<ol>
  <li> &alpha;=0.01.</li>
  <li> H<sub>A</sub>: &mu;>0 and H<sub>O</sub>:&mu;=0, where &mu; is the mean sea level rise rate for all ecosystems. [Note that a mean of 0 means no change.]</li>
  <li> A one-sample t-test is required because a quantitative variable (sea level rise rate) was measured on individuals from one group or population (ecosystems), &sigma; is UNknown, and the population mean is being compared to a specific value in the null hypothsis.</li>
  <li> An observational study without obvious randomization was used.</li>
  <li> The assumptions are met because &sigma; is unknown, n=23&ge;15 and the background suggests that the distribution is not strongly skewed. Thus, the sampling distribution of the test statistic should follow a t-distribution.</li>
  <li> The statistic is x&#772;=0.059.</li>
  <li> The test statistic is  t=$\frac{0.059-0}{\frac{0.135}{\sqrt{23}}}$ = 2.107 with 23-1=22 df.</li>
  <li> The p-value is `r kPvalue(distrib(2.107,distrib="t",df=22,lower.tail=FALSE,plot=FALSE),include.p=FALSE,latex=FALSE)`.</li>
  <li> The H<sub>O</sub> is not rejected because the p-value>&alpha;.</li>
  <li> The mean sea level rise rate does not appear to be greater than 0, indicating that the sea level has not increased significantly over the period of study.</li>
</ol>

R Appendix.
```{r eval=FALSE, prompt=FALSE}
library(NCStats)
( distrib(2.107,distrib="t",df=22,lower.tail=FALSE) )
```

----

## Thickness of the Ozone Layer

```{r OzoneCode, echo=FALSE, results='hide'}
ozo <- read.csv("https://github.com/droglenc/NCData/raw/master/OzoneSWI.csv")
( ozo.t <- t.test(ozo$Ozone,mu=300,conf.level=0.99) )
```

<ol>
<li>&alpha;=0.01</li>
<li>H<sub>0</sub>:&mu;=300, H<sub>A</sub>: &mu;&ne;300, where &mu; is the mean thickness of the ozone layer from ALL locations.</li>
<li>A one-sample t-test is required because (i) a quantitative variable (thickness) was measured, (ii)the individuals are from one group or population (the ozone layer over Arosa, SWI), and (iii) &sigma; is not known. Thus, the population mean is being compared to a specific value in the null hypothesis.</li>
<li>An observational study of 45 random samples of ozone was conducted.</li>
<li>The assumptions are met because n=45&ge;40 and &sigma; is UNknown.</li>
<li>x&#772;=`r formatC(ozo.t$estimate,format="f",digits=0)` (`r tbls("Ozone",display="cite")`).</li>

`r tbls("Ozone")`

```{r echo=FALSE}
kHtest(ozo.t)
```
<li>The test statistic is Z=`r formatC(ozo.t$statistic,format="f",digits=3)` with `r formatC(ozo.t$parameter,format="f",digits=0)` df (`r tbls("Ozone",display="cite")`).</li>
<li>The p-value `r kPvalue(ozo.t$p.value,include.p=FALSE,latex=FALSE)` (`r tbls("Ozone",display="cite")`).</li>
<li>The H<sub>0</sub> is rejected because the p-value<&alpha; (`r tbls("Ozone",display="cite")`).</li>
<li>The mean thickness of the ozone layer at ALL areas abova Arosa, SWI appears to be different (specifically greater) than 300 Dobson units.</li>
<li>I am 99% confident that the mean thickness of the ozone layer in ALL areas above Arosa, SWI is between `r formatC(ozo.t$conf.int[1],format="f",digits=0)` and  `r formatC(ozo.t$conf.int[2],format="f",digits=0)` Dobson Units (`r tbls("Ozone",display="cite")`).</li>
</ol>

R Appendix
```{r eval=FALSE, prompt=FALSE}
<<OzoneCode>>
```

----

## Fecal Coliform Counts III
```{r CFU2Calc, echo=FALSE, results='hide'}
df <- read.csv("../FecalColiform.csv")
( fc.t <- t.test(df$CFU,mu=150,alt="greater",conf.level=0.9) )
```

<ol>
<li>&alpha;=0.10.</li>
<li>H<sub>A</sub>: &mu;>150 and H<sub>0</sub>: &mu;=150, where &mu; is the mean number of CFU per 100 ml in ALL samples from this lake on this date.</li>
<li>1-sample t-test because (i) one group or population (this lake) was sampled, (ii) a quantitative variable (number of CFU per 100 ml) was recorded, and (iii) &sigma; is not known.</li>
<li>An observational study without clear randomization of 25 water samples.</li>
<li>The assumptions are met because (i) &sigma; is not known and (ii) n=25&ge;15 and the histogram (`r figs("FChist",display="cite")`) is not strongly skewed.</li>
```{r CFU2Hist, echo=FALSE, fig.width=4, fig.height=4}
hist(~CFU,data=df,xlab="Colony Forming Units per 100 ml")
```

`r figs("FChist")`

<li>x&#772;=`r formatC(fc.t$estimate,format="f",digits=1)` (`r tbls("FC",display="cite")`).</li>

`r tbls("FC")`

```{r echo=FALSE}
kHtest(fc.t)
```
<li>The test statistic is t=`r formatC(fc.t$statistic,format="f",digits=3)` with `r formatC(fc.t$parameter,format="f",digits=0)` df (`r tbls("FC",display="cite")`).</li>
<li>The p-value `r kPvalue(fc.t$p.value,include.p=FALSE,latex=FALSE)` (`r tbls("FC",display="cite")`).</li>
<li>The H<sub>0</sub> is rejected because the p-value<&alpha;.</li>
<li>The mean CFU per ALL 100 ml samples of water from this lake at this time appears to be greater than 150 CFU per 100 ml. Thus, it appears that the lake will need to be closed swimming.</li>
<li>I am 90% confident that CFU per ALL 100 ml of water sampled from this lake on this date is greater than `r formatC(fc.t$conf.int[1],format="f",digits=1)` CFU per 100 ml (`r tbls("FC",display="cite")`).</li>
</ol>

R Appendix
```{r eval=FALSE, prompt=FALSE}
<<CFU2Calc>>
<<CFU2Hist>>
```

----
