---
title: "Answer Key"
subtitle: "Hypothesis Testing CE"
author: Derek H. Ogle
layout: page
css: "/css/modules.css"
output:
  html_document:
    fig_height: 3.5
    fig_width: 3.5
    self_contained: false
---

```{r echo=FALSE, eval=FALSE}
## Renders an appropriate HTML file and moves to CE directory
source("modules/CE/1_CE_Keys/zzz_modHTML_CEKeys.R")
modHTML_CEKeys("KEY_HypTesting_CE")
```

```{r echo=FALSE, results='hide', message=FALSE, warning=FALSE}
library(NCStats)
source("../../../rhelpers/knitr_setup.R")
library(captioner)
figs <- captioner(prefix="Figure")
figs(name="P1","Normal distribution representing the p-value calculation for the first example.")
figs(name="P2","Normal distribution representing the p-value calculation for the second example.")
figs(name="P3","Normal distribution representing the p-value calculation for the third example.")

figs(name="P4","Normal distribution representing the p-value calculation for the fourth example.")
figs(name="P5","Normal distribution representing the p-value calculation for the fifth example.")
```

----

## Identifying Hypotheses

<div class="alert alert-warning">
<strong>When identifying the hypotheses note:</strong> 
<ul>
  <li>Each statistical hypothesis must contain a parameter -- either &mu; or p. That parameter must be defined (note the "where ..." constructions below).</li>
  <li>Each statistical hypothesis must contain a specific value that the parameter is compared to.</li>
  <li>The null hypothesis (i.e., H<sub>0</sub>) must contain the equals sign. No other mathematical sign is allowed.</li>
  <li>The alternative hypothesis (i.e., H<sub>A</sub> must contain either the less than (<), greater than (>), or not equals (&ne;) sign. No other mathematical sign is allowed.</li>
</ul>
</div>

<ol>
<li>H<sub>A</sub> &mu; < 90 vs. H<sub>0</sub> &mu; = 90, where &mu; is the mean number of murders for all burroughs in 2010.</li>
<li>H<sub>A</sub> &mu; > 15 vs. H<sub>0</sub> &mu; = 15, where &mu; is the mean length of all oil changes at the Toyota dealership.</li>
<li>H<sub>A</sub> &mu; &ne; 22500 vs. H<sub>0</sub> &mu; = 22500, where &mu; is the mean cost of all bariatric surgeries.</li>
<li>H<sub>A</sub> p > 0.61 vs. H<sub>0</sub> p = 0.61, where p is the proportion of all Washburn High School students that are involved in at least one extracurricular activity.</li>
</ol>

----

## P-Value Calculations and Decisions I

<div class="alert alert-warning">
<strong>Note:</strong> 
<ul>
<li>When writing the definition of the p-value in the context of the problem you are replacing "the observed statistic" with the value of x&#772;; "more extreme" with "less", "greater", or "different" depending on the sign in H<sub>A</sub>; and the "null hypothesis is true" with the value of &mu; in "the probability of the observed statistic or a value more extreme assuming the null hypothesis is true."</li>
</ul>
</div>

<ol>
<li>The p-value is "the probability of observing a sample mean of 11.2 or 'different' if the population mean is 14." Reject H<sub>0</sub> because p-value=`r formatC(2*distrib(11.2,mean=14,sd=6/sqrt(25)),format="f",digits=4)`<&alpha; (`r figs("P1",display="cite")`).</li>
```{r p1, echo=FALSE, results='hide'}
2*distrib(11.2,mean=14,sd=6/sqrt(25))
```

`r figs("P1")`

<li>The p-value is "the probability of observing a sample mean of 79.5 or greater if the population mean is 75." Reject H<sub>0</sub> because p-value=`r formatC(distrib(79.5,mean=75,sd=12/sqrt(50),lower.tail=FALSE),format="f",digits=4)`<&alpha; (`r figs("P2",display="cite")`).</li>
```{r p2, echo=FALSE}
distrib(79.5,mean=75,sd=12/sqrt(50),lower.tail=FALSE)
```

`r figs("P2")`

<li>The p-value is "the probability of observing a sample mean of 13700 or less if the population mean is 15000." Do not reject H<sub>0</sub> because p-value=`r formatC(distrib(13700,mean=15000,sd=8000/sqrt(50)),format="f",digits=4)`>&alpha; (`r figs("P3",display="cite")`).</li>

```{r p3, echo=FALSE}
distrib(13700,mean=15000,sd=8000/sqrt(50))
```

`r figs("P3")`

</ol>

R Appendix.
```{r eval=FALSE, prompt=FALSE}
<<p1>>
<<p2>>
<<p3>>
```

----

## Body Temperature

<div class="alert alert-warning">
<strong>In the following two applied questions note:</strong> 
<ul>
<li>The hypotheses must be defined as noted in the first class exercise above.</li>
<li>The x&#772; is computed with `Summarize()` with the data file loaded into R.</li>
<li>The summary statement (question 5 in each) is your answer to the research hypothesis/question based on your p-value results. Generally, this is a restatement about whether you believe (i.e., rejected H<sub>0</sub>) or don't believe (i.e., did not reject H<sub>0</sub>) the H<sub>A</sub> because the H<sub>A</sub> is generally formed from the research hypothesis. This statement should be in the context of the problem and should be made clear that it is about the parameter (see "mean" in each statement below) in the population (see "all" in each statement below). </li>
<li>Your p-value may be slightly (though not dramatically) different if you rounded your x&#772; and SE differently than I did.</li>
</ul>
</div>

<ol>
<li>H<sub>A</sub> &mu; &ne; 37 vs. H<sub>0</sub> &mu; = 37</li>
```{r echo=FALSE}
d <- read.csv("https://github.com/droglenc/NCData/raw/master/NormTemp.csv")
```

<li>x&#772;=`r formatC(mean(d$bodytemp),format="f",digits=3)`</li>
<li>p-value=`r formatC(2*distrib(round(mean(d$bodytemp),3),mean=37,sd=0.41/sqrt(nrow(d))),format="f",digits=9)`</li>
<li>Reject H<sub>0</sub> because p-value < alpha;.</li>
<li>Average body temperature is somewhat less (but significantly) less than 37<sup>o</sup>C for all individuals in this population.</li>
</ol>

R Appendix.
```{r eval=FALSE, prompt=FALSE}
d <- read.csv("NormTemp.csv")
Summarize(~bodytemp,data=d,digits=3)
2*distrib(36.808,mean=37,sd=0.41/sqrt(130))
```

----

## Beetle Size
```{r echo=FALSE}
d <- read.csv("https://github.com/droglenc/NCData/raw/master/Beetles.csv")
d <- filterD(d,species=="Halticus.oleracea")
```

1. H<sub>A</sub> &mu; > 190 vs. H<sub>0</sub> &mu; = 190, where &mu; is the mean thorax length (&mu;m) for all *Halticus oleracea* beetles in this population.
1. x&#772;=`r formatC(mean(d$thorax),format="f",digits=3)` &mu;m.
1. p-value=`r formatC(distrib(round(mean(d$thorax),3),mean=190,sd=14/sqrt(nrow(d)),lower.tail=FALSE),format="f",digits=3)`.
1. Do not reject H<sub>0</sub> because the p-value > &alpha;.
1. The average thorax length for all *Halticus oleracea* beetles in this population does not appear to be greater than 190 &mu;m.

R Appendix.
```{r eval=FALSE, prompt=FALSE}
setwd("c:/stats")
d <- read.csv("Beetles.csv")
d <- filterD(d,species=="Halticus.oleracea")
Summarize(~thorax,data=d,digits=3)
distrib(194.167,mean=190,sd=14/sqrt(18),lower.tail=FALSE)
```

----

## P-Value Calculations and Decisions II

<ol>
<li>The p-value is "the probability of observing a sample mean of 918 or greater if the population mean is 880." Reject H<sub>0</sub> because p-value=`r formatC(distrib(918,mean=880,sd=90/sqrt(80),lower.tail=FALSE),format="f",digits=4)`<&alpha; (`r figs("P4",display="cite")`).</li>

```{r p4, echo=FALSE}
distrib(918,mean=880,sd=90/sqrt(80),lower.tail=FALSE)
```

`r figs("P4")`

<li>The p-value is "the probability of observing a sample mean of 824 or 'different' if the population mean is 800." Do not reject H<sub>0</sub> because p-value=`r formatC(2*distrib(824,mean=800,sd=60/sqrt(25),lower.tail=FALSE),format="f",digits=4)`>&alpha; (`r figs("P5",display="cite")`).</li>

```{r p5, echo=FALSE, results='hide'}
2*distrib(824,mean=800,sd=60/sqrt(25),lower.tail=FALSE)
```

`r figs("P5")`

<li>The p-value is "the probability of observing a sample mean of 73 or less if the population mean is 80." The null hypothesis is rejected because the p-value (=`r formatC(distrib(73,mean=80,sd=20/sqrt(30)),format="f",digits=4)`)<&alpha;.</li>
<li>The p-value is "the probability of observing a sample mean of 1370 or 'different' if the population mean is 1500." The null hypothesis is not rejected because the p-value (=`r formatC(2*distrib(1370,mean=1500,sd=800/sqrt(40)),format="f",digits=4)`)>&alpha;.</li>
</ol>

R Appendix.
```{r eval=FALSE, prompt=FALSE}
<<p4>>
<<p5>>
distrib(73,mean=80,sd=20/sqrt(30))
2*distrib(1370,mean=1500,sd=800/sqrt(40))
```
----
