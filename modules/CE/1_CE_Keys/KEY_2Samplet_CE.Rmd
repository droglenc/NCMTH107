---
title: "Answer Key"
subtitle: "2-Sample t CE"
author: Derek H. Ogle
layout: page
css: "/css/modules.css"
output:
  html_document:
    fig_height: 3.5
    fig_width: 3.5
    self_contained: false
---

```{r echo=FALSE, eval=FALSE}
## Renders an appropriate HTML file and moves to CE directory
source("modules/CE/1_CE_Keys/zzz_modHTML_CEKeys.R")
modHTML_CEKeys("KEY_2Samplet_CE")
```

```{r echo=FALSE, results='hide', message=FALSE, warning=FALSE}
library(NCStats)
source("../../../rhelpers/knitr_setup.R")
library(captioner)
tbls <- captioner(prefix="Table")
figs <- captioner(prefix="Figure")
tbls(name="Deliveries","Results from the two-sample t-test for testing that the mean delivery time was lower for the Bosnian than the Persian Gulf war.")
figs(name="DeliveriesHist","Histograms of the delivery times for military supplies in the Bosnian and Persian Gulf war.")
tbls(name="mussels1","Levene's test results for testing equal variances among impacted and reference groups.")
tbls(name="mussels2","Two-sample t-test results for testing that the mean mercury levels in mussels differed between the impacted and reference sites.")
```

----

<div class="alert alert-warning">
<strong>Note:</strong> 
<ul>
<li>Make sure to define your parameters in Step 2.</li>
<li>Make sure to describe your evidence in Step 3 for why you are performing a 2-sample t-test. It is not adequate to simply say "because there is a quantitative response variable, two groups are being tested, and the groups are independent." At least say what the response variable is and what the two groups are and provide some discussion for why you think the groups are independent.</li>
<li>Also make sure to describe your evidence in Step 5 for why the assumptions are met. It is not adequate to simply say "n<sub>1</sub>+n<sub>2</sub>&ge;40" or "n<sub>1</sub>+n<sub>2</sub>&ge;15 and the sample distributions are not strongly skewed." You should state the actual n<sub>1</sub>+n<sub>2</sub> value and direct the reader to how you know the distributions are not strongly skewed (i.e., likely to histograms).</li>
<li>In hand calculations, note that the test statistic (t in Step 7) is NOT the critical value (i.e., t<sup>*</sup>) needed for the confidence region (in Step 11).</li>
<li>Note the use of "mean" in both Steps 10 and 11. The test is for mean number of plants that germinated, not number of plants that germinated.</li>
</ul>
</div>

----

## Compost Type and Germination Rates
```{r GerminationCalc, echo=FALSE, results='hide', fig.show='hide'}
xbar1 <- 42.67; s1 <- 4.33; n1 <- 18
xbar2 <- 28.90; s2 <- 3.21; n2 <- 10
df <- n1+n2-2
sp2 <- ((n1-1)*(s1^2)+(n2-1)*(s2^2))/df
se <- sqrt(sp2*(1/n1+1/n2))
stat <- xbar1-xbar2
t <- stat/se
pv <- distrib(t,distrib="t",df=df,lower.tail=FALSE)
lcb <- stat+distrib(0.9,type="q",distrib="t",df=df,lower.tail=FALSE)*se
```

<ol>
<li>&alpha; = 0.10.</li>
<li>H<sub>A</sub>: &mu;<sub>b</sub>-&mu;<sub>h</sub> &gt; 0 and H<sub>0</sub>: &mu;<sub>b</sub>-&mu;<sub>h</sub> = 0, where &mu; is the mean number of germinated plants, b is the bought compost, and h is the homemade compost.</li>
<li>2-sample t-test because (i) two groups/populations are considered (bought and homemade compost), (ii) a quantitative variable (number germinated) was recorded, and (iii) individuals in the groups are independent (there is no known connection between all pairs of containers with bought and homemade compost).</li>
<li>An experimental study was conducted without obvious random selection of the containers wtih soil, but with randomization allocation (placement of containers in the greenhouse).</li>
<li>The assumptions are met because (i) the samples are independent (as described above), (ii) n<sub>b</sub>+n<sub>h</sub> = 18+10 = 28 &gt; 15 and the two sample distributions (shown on the handout) are not obviously strongly skewed, and (iii) the variances appear to be equal (Levene's p-value = 0.2414 &gt; &alpha;).</li>
<li>x&#772;<sub>b</sub>-x&#772;<sub>h</sub> = `r xbar1`-`r xbar2` = `r stat`.</li>
<li>t = `r formatC(t,format="f",digits=4)` with `r df` df. Note that $s_p^2$=`r formatC(sp2,format="f",digits=3)` and the SE is `r formatC(se,format="f",digits=3)`.</li>
<li>p-value`r kPvalue(pv,include.p=FALSE,latex=FALSE)` (more specifically `r formatC(pv,digits=4)`).</li>
<li>Reject H<sub>0</sub> because the p-value &lt; &alpha;.</li>
<li>It appears that the the mean number of plants that germinate is significantly lower for the homemade than the bought compost. Thus, the homemade compost "performs" worse than the store bought compost and may lead to increased costs for the greenhouse.</li>
<li>I am 90% confident that the mean number of plants that germinated with the bought compost is at least `r formatC(lcb,format="f",digits=1)` plants greater than the mean number of plants that germinated with the homemade compost.</li>
</ol>

R Appendix.
```{r eval=FALSE, prompt=FALSE}
<<GerminationCalc>>
```

----

## Delivering Military Supplies
```{r DeliveriesData, echo=FALSE, results='hide'}
del <- data.frame(war=rep(c("Gulf","Bosnia"),each=9),
                  time=c(28.0,20.0,26.5,10.6,9.1,35.2,29.1,41.2,27.5,
                         15.1,6.4,5.0,11.4,6.5,6.5,3.0,7.0,3.5))
```

```{r DeliveriesCode, echo=FALSE, results='hide'}
(del.lev <- levenesTest(time~war,data=del) )
( del.t <- t.test(time~war,data=del,var.equal=TRUE,alt="less") )
```

<ol>
<li>&alpha; = 0.05</li>
<li>H<sub>A</sub>: &mu;<sub>b</sub>-&mu;<sub>g</sub> &lt; 0 and H<sub>0</sub>: &mu;<sub>b</sub>-&mu;<sub>g</sub> = 0, where &mu; is the mean time to deliver ALL shipments, b is for Bosnia, and g is for Persian Gulf War.</li>
<li>2-sample t-test because (i) two groups/populations are considered (Bosnia and Persian Gulf), (ii) a quantitative variable (delivery time) was recorded, and (iii) the indivduals in the groups are independent (there is no known connection between all deliveries to the two wars).</li>
<li>An observational study without clear randomization of the two samples.</li>
<li>The assumptions are met because (i) the samples are independent (as described above), (ii) n<sub>b</sub>+n<sub>g</sub> = 9+9 = 18 &gt; 15 and the two sample distributions (`r figs("DeliveriesHist",display="cite")`) are not obviously strongly skewed (also told to assume that the distribution are not strongly skewed), and (iii) the variances appear to be equal (Levene's p-value = `r  kPvalue(del.lev$"Pr(>F)"[1],include.p=FALSE)` &gt; &alpha;).</li>
```{r DeliveriesHist, fig.width=7, fig.height=3.5, echo=FALSE}
hist(time~war,data=del)
```

`r figs("DeliveriesHist")`

<li>x&#772;<sub>b</sub>-x&#772;<sub>g</sub> = `r formatC(del.t$estimate[1],format="f",digits=2)`-`r formatC(del.t$estimate[2],format="f",digits=2)` = `r formatC(del.t$estimate[1]-del.t$estimate[2],format="f",digits=2)` (`r tbls("Deliveries",display="cite")`).</li>

`r tbls("Deliveries")`

```{r echo=FALSE}
kHtest(del.t)
```
<li>The test statistic is t = `r formatC(del.t$statistic,format="f",digits=3)` with `r formatC(del.t$parameter,format="f",digits=0)` df (`r tbls("Deliveries",display="cite")`).</li>
<li>The p-value = `r kPvalue(del.t$p.value,include.p=FALSE,latex=FALSE)` (`r tbls("Deliveries",display="cite")`).</li>
<li>The H<sub>0</sub> is rejected because the p-value &lt; &alpha; (`r tbls("Deliveries",display="cite")`).</li>
<li>The mean delivery time was significantly lower in Bosnia than in the Persian Gulf War. Thus, the new "just-in-time" mentality for deliveries appears to have resulted in quicker delivery times.</li>
<li>I am 95% confident that the mean delivery time for Bosnia was more than `r formatC(-1*del.t$conf.int[2],format="f",digits=1)` days faster than for the Persian Gulf War (`r tbls("Deliveries",display="cite")`).</li>
</ol>

R Appendix
```{r eval=FALSE, prompt=FALSE}
del <- read.csv("Deliveries.csv")
<<DeliveriesHist>>
<<DeliveriesCode>>
```

----

## Commitment to Adult Animals

<ol>
  <li>&alpha;=0.01.</li>
  <li>H<sub>O</sub>:&mu;<sub>did</sub>=&mu;<sub>didnot</sub> (or &mu;<sub>did</sub>-&mu;<sub>didnot</sub>=0) and H<sub>A</sub> is &mu;<sub>did</sub>>&mu;<sub>didnot</sub> (or &mu;<sub>did</sub>-&mu;<sub>didnot</sub>>0), where &mu; is the mean commitment level, "did" corresponds to the "did evacuate" group, and "didnot" corresponds to the "did not evacuate" group.</li>
  <li>A two-sample t-test is required because a quantitative variable (commitment level score) was measured on two groups ("did evacuate" and "did not evacuate") that were **IN**dependent (no connection between individuals that did and those that did not evacuate their pets).</li>
  <li>The data appear to be part of a voluntary response observational study without clear randomization.</li>
  <li>The assumptions are met because the two groups appear to be independent, the sample size (n<sub>did</sub>+n<sub>didnot</sub>=241) is >40 and we were told that the p-value for Levene's test of the homogeneity of variance test is "large" (i.e., >0.01) so that it appears that the variances between groups are equal. Therefore, the test statistic computed below should reasonably follow a t-distribution with n<sub>did</sub>+n<sub>didnot</sub>-2=239 df.</li>
  <li>The statistic is x&#772;<sub>did</sub>-x&#772;<sub>didnot</sub> = 7.694-6.640 = 1.054. The pooled sample variance is,
      \[s_{p}^{2}=\frac{(116-1)3.410^{2}+(125-1)3.102^{2}}{116+125-2} = 10.58749 \]
       The standard error of the statistic is,
       \[ SE_{\bar{x}_{did}-\bar{x}_{didnot}}=\sqrt{10.58749\left(\frac{1}{116}+\frac{1}{125} \right)} = 0.4194894  \]
  <li>The t test statistic is $\frac{1.054-0}{0.4194894}$ = 2.513 with 116+125-2 = 239 df.</li>
  <li>The p-value is `r kPvalue(distrib(2.512578,distrib="t",df=239,lower.tail=FALSE,plot=FALSE),include.p=FALSE,latex=FALSE)`.</li>
  <li>The H<sub>O</sub> is rejected because the p-value < &alpha;.</li>
  <li>The average commitment to animals was significantly greater for those people that did evacuate their pets as compared to those people that did not evacuate their pets.</li>
  <li>The 99% lower bound is 1.054-2.342051*0.419 = 0.073. One is 99% confident that the mean level of commitment for those that evacuated their pets is at least 0.073 greater than those that did not evacuate their pets.</li>
</ol>

R Appendix.
```{r eval=FALSE, prompt=FALSE}
library(NCStats)
( distrib(2.512578,distrib="t",df=239,lower.tail=FALSE) )
( distrib(0.99,distrib="t",df=239,type="q",lower.tail=FALSE) )
```

----

## Methyl Mercury in Mussels

```{r echo=FALSE}
impacted <- c(0.011,0.054,0.056,0.095,0.051,0.077)
reference <- c(0.031,0.040,0.029,0.066,0.018,0.042,0.044)
df <- data.frame(mhg=c(impacted,reference),
                 grp=factor(rep(c("impacted","reference"),
                                c(length(impacted),length(reference)))))
```
```{r Calc2, echo=FALSE, results='hide'}
( m.lt <- levenesTest(mhg~grp,data=df) )
( m.t <- t.test(mhg~grp,data=df,var.equal=TRUE) )
```

<ol>
  <li>&alpha;=0.05.</li>
  <li>H<sub>O</sub>:&mu;<sub>i</sub>=&mu;<sub>r</sub> (or &mu;<sub>i</sub>-&mu;<sub>r</sub>=0) and H<sub>A</sub> is &mu;<sub>i</sub>&ne;&mu;<sub>r</sub> (or &mu;<sub>i</sub>-&mu;<sub>r</sub>&ne;0), where &mu; is the mean methyl mercury level, i corresponds to the "impacted" group, and r corresponds to the "reference" group.</li>
  <li>A two-sample t-test is required because quantitative variable (methyl mercury level) was measured on two groups ("impacted" and "reference" sites) that were **IN**dependent (no connection between sites at the two locations).</li>
  <li>The data appear to be part of an observational study without clear randomization.</li>
  <li>The assumptions are not quite met but we will continue anyway. The two groups appear to be independent. The variances appear to be equal because the p-value from the Levene's test is "large" (i.e., `r kPvalue(m.lt[1,3],latex=FALSE)`>0.05; `r tbls("mussels1",display="cite")`). The sample size (n<sub>i</sub>+n<sub>r</sub>=`r formatC(m.t$parameter+2,format="f",digits=0)`) is not >15 and there is not enough data to make useful histograms. Therefore, the test statistic computed below may not follow a t-distribution with n<sub>i</sub>+n<sub>r</sub>-2=`r formatC(m.t$parameter,format="f",digits=0)` df.</li>

`r tbls("mussels1")`

```{r echo=FALSE,background="white"}
attr(m.lt,"heading") <- NULL
m.lt
```

  <li>The statistic is x&#772;<sub>i</sub>-x&#772;<sub>r</sub> = `r formatC(m.t$estimate[1],format="f",digits=4)` - `r formatC(m.t$estimate[2],format="f",digits=4)` = `r formatC(m.t$estimate[1]-m.t$estimate[2],format="f",digits=4)` (`r tbls("mussels2",display="cite")`).</li>

`r tbls("mussels2")`

```{r echo=FALSE,background="white"}
kHtest(m.t)
```

  <li>The t test statistic is `r formatC(m.t$statistic,format="f",digits=4)` with `r formatC(m.t$parameter,format="f",digits=0)` df (`r tbls("mussels2",display="cite")`).</li>
  <li>The p-value is `r kPvalue(m.t$p.value,include.p=FALSE,latex=FALSE)` (`r tbls("mussels2",display="cite")`).</li>
  <li>The H<sub>O</sub> is not rejected because the p-value > &alpha;.</li>
  <li>Mean methyl mercury levels do not appear to differ between mussels from the impacted and reference sites.</li>
</ol>

R Appendix.
```{r eval=FALSE, prompt=FALSE}
setwd('C:/aaaWork/Books/IntroStats/HW/')
df <- read.csv("Mussels.csv")
<<Calc2>>
```

----

## P-Value Calculations and Decisions

<ol>
<li>See below.</li>
```{r 2t1, echo=FALSE, fig.show='hide'}
xbar1 <- 27.3; xbar2 <- 23.2
s1 <- 6.6; s2 <- 6.4
s1sq <- s1^2; s2sq <- s2^2
n1 <- 12; n2 <- 14
df <- n1+n2-2
spsq <- ((n1-1)*s1sq+(n2-1)*s2sq)/df
se <- sqrt((1/n1+1/n2)*spsq)
stat <- xbar1-xbar2
t <- stat/se
pv <- distrib(t,distrib="t",df=df,lower.tail=FALSE)
```
<ol type="a">
<li>t = `r formatC(t,format="f",digits=3)` with `r df` df (and noting that s<sub>p</sub><sup>2</sup> = `r formatC(spsq,format="f",digits=3)` and SE = `r formatC(se,format="f",digits=3)`).</li>
<li>p-value=`r formatC(pv,format="f",digits=4)`.</li>
<li>Reject H<sub>0</sub> because p-value &lt; &alpha;.</li>
</ol>

<li>See below.</li>
```{r 2t2, echo=FALSE, fig.show='hide'}
xbar1 <- 79.5; xbar2 <- 87.5
s1 <- 8; s2 <- 9
s1sq <- s1^2; s2sq <- s2^2
n1 <- n2 <- 15
df <- n1+n2-2
spsq <- ((n1-1)*s1sq+(n2-1)*s2sq)/df
se <- sqrt((1/n1+1/n2)*spsq)
stat <- xbar1-xbar2
t <- stat/se
pv <- distrib(t,distrib="t",df=df)
```
<ol type="a">
<li>t = `r formatC(t,format="f",digits=3)` with `r df` df (and noting that s<sub>p</sub><sup>2</sup> = `r formatC(spsq,format="f",digits=3)` and SE = `r formatC(se,format="f",digits=3)`).</li>
<li>p-value = `r formatC(pv,format="f",digits=4)`.</li>
<li>Reject H<sub>0</sub> because p-value &lt; &alpha;.</li>
</ol>

<li>See below.</li>
```{r 2t3, echo=FALSE, fig.show='hide'}
xbar1 <- 307; xbar2 <- 268
s1 <- 56; s2 <- 64
s1sq <- s1^2; s2sq <- s2^2
n1 <- 20; n2 <- 15
df <- n1+n2-2
spsq <- ((n1-1)*s1sq+(n2-1)*s2sq)/df
se <- sqrt((1/n1+1/n2)*spsq)
stat <- xbar1-xbar2
t <- stat/se
pv <- 2*distrib(t,distrib="t",df=df,lower.tail=FALSE)
```
<ol type="a">
<li>t = `r formatC(t,format="f",digits=3)` with `r df` df (and noting that s<sub>p</sub><sup>2</sup> = `r formatC(spsq,format="f",digits=3)` and SE = `r formatC(se,format="f",digits=3)`).</li>
<li>p-value = `r formatC(pv,format="f",digits=4)`.</li>
<li>Do Not Reject H<sub>0</sub> because p-value  &gt;  &alpha;.</li>
</ol>

</ol>

----

## Confidence Interval Calculations

<ol>
<li>See below.</li>
<ol type="a">
```{r echo=FALSE, fig.show="hide"}
<<2t1>>
tstar <- distrib(0.9,df=df,type="q",lower.tail=FALSE,distrib="t")
lcb <- stat+tstar*se
```

<li>C = 0.90</li>
<li>Lower bound</li>
<li>t* = `r formatC(tstar,format="f",digits=3)`.</li>
<li>`r formatC(lcb,format="f",digits=3)`.</li>
<li>I am 90% confident that the true difference in population means is greater than `r formatC(lcb,format="f",digits=3)`. More specifically, I am 90% confident that the true mean for the first group is <i>at least</i> `r formatC(lcb,format="f",digits=3)` greater than the true mean for the second group.</li>
</ol>

<li>See below.</li>
<ol type="a">
```{r echo=FALSE, fig.show="hide"}
<<2t2>>
tstar <- distrib(0.95,df=df,type="q",distrib="t")
ucb <- stat+tstar*se
```

<li>C = 0.95</li>
<li>Upper bound</li>
<li>t* = `r formatC(tstar,format="f",digits=3)`.</li>
<li>`r formatC(ucb,format="f",digits=3)`.</li>
<li>I am 95% confident that the true difference in population means is less than `r formatC(ucb,format="f",digits=3)`. More specifically, I am 90% confident that the true mean for the first group is <i>at least</i> `r formatC(ucb,format="f",digits=3)` less than the true mean for the second group.</li>
</ol>


<li>See below.</li>
<ol type="a">
```{r echo=FALSE, fig.show="hide"}
<<2t3>>
tstar <- distrib(0.975,df=df,type="q",distrib="t")
ci <- stat+c(-1,1)*tstar*se
```

<li>C = 0.95</li>
<li>interval</li>
<li>t* = &pm;`r formatC(tstar,format="f",digits=3)`.</li>
<li>(`r formatC(ci[1],format="f",digits=3)`,`r formatC(ci[2],format="f",digits=3)`).</li>
<li>I am 95% confident that the true difference in population means is between `r formatC(ci[1],format="f",digits=3)` and  `r formatC(ci[2],format="f",digits=3)`. [<i>This one is difficult to interpret because the H<sub>0</sub> was not rejected. However, this shows that the true mean for the first group could be `r formatC(-1*ci[1],format="f",digits=3)` lower or `r formatC(ci[2],format="f",digits=3)` greater than the mean for the second group.</i>]</li>
</ol>

</ol>

----
