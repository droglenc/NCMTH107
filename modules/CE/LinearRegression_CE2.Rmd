---
layout: page
title: Additional Exercises
subtitle: Linear Regression
author: Derek H. Ogle
css: "/css/modules.css"
output:
  html_document:
    fig_height: 3.5
    fig_width: 3.5
    lib_dir: zlibs
    self_contained: no
---

```{r echo=FALSE, eval=FALSE}
# Renders an appropriate HTML file for the webpage
setwd("C:/aaaWork/Web/GitHub/NCMTH107/modules/CE/")
source("../../rhelpers/rhelpers.R")
modHTML("LinearRegression_CE2")
```

```{r echo=FALSE, results='hide', message=FALSE}
library(NCStats)
library(tidyverse)
source("../../rhelpers/knitr_setup.R")
```

----

## Avocado Sales
<img src="http://derekogle.com/NCMTH107/modules/CE/zimgs/avocados.jpg" alt="Avocados" class="img-right">
Marketers examined the relationship between the price of a single *organic* avocado and the number of bags of those avocados sold in markets in the Great Lakes region from 2015-2017.[^avocdata] The results are shown below.

```{r echo=FALSE, message=FALSE, warning=FALSE, fig.width=7, fig.height=3.1}
avoc <- read.csv("https://raw.githubusercontent.com/droglenc/NCData/master/Avocados.csv",quote="") %>%
  filter(region=="GreatLakes",type=="organic",year<2018) %>%
  mutate(type=factor(type),year=factor(year)) %>%
  select(year,region,Total.Volume,AveragePrice)

ggplot(data=avoc,mapping=aes(x=AveragePrice,y=Total.Volume)) +
  geom_point(pch=21,color="black",fill="lightgrey",size=2) +
  geom_smooth(method="lm",se=FALSE,color="black",size=1) +
  stat_SLR_equation(aes(label=..eq.label..),
                    label.x.npc=1,label.y.npc=1,hjust=1,cf.digits=0) +
  stat_SLR_equation(aes(label=..rr.label..),label.x.npc=1,label.y.npc=0.90,hjust=1) +
  scale_x_continuous(labels=scales::dollar) +
  scale_y_continuous(labels=scales::comma) +
  labs(y="Number of Bags Sold",x="Average Price") +
  theme_NCStats() +
  theme(aspect.ratio=1,plot.title=element_text(size=12)) +
  facet_wrap(~year,nrow=1)
```

Use the results for **2015** to answer the questions below.

1. In terms of the variables of this problem, what is the equation of the best-fit line?
1. In terms of the variables of this problem, INTERPRET the value of the slope?
1. In terms of the variables of this problem, INTERPRET the value of the y-intercept?
1. What is the predicted number of bags sold if the price was $1.50?
1. What is the predicted body mass for a flipper length of $2.00 mm??
1. What is the residual if the price was $1.60 and 105,000 bags were sold?
1. What proportion of the variability in bags sold is explained by knowing the price of an avocado?
1. What is the correlation coefficient between the price of avocado and the number of bags sold?
1. How much would you expect the number of bags sold to change if the average price increased by $0.10?
1. What aspect of this regression analysis concerns you (i.e., consider the regression assumptions)?

----

## Penguin Size
<img src="http://derekogle.com/NCMTH107/modules/CE/zimgs/Chinstrap_Penguin.jpg" alt="Chinstrap Penguin" class="img-right">
Kirsten Gorman examined various aspects of three species of penguins (Adelie, Chinstrap, and Gentoo) on Palmer Island, Antarctica.[^PengData] In one part of her research she examined the relationship between flipper length (mm) and body mass (g) with the hope of being able to predice body mass from flipper length. The results of her analysis are shown below.

```{r echo=FALSE, message=FALSE, warning=FALSE, fig.width=7, fig.height=3.1}
d <- read.csv("https://raw.githubusercontent.com/allisonhorst/penguins/master/data/penguins_lter.csv") %>%
  janitor::clean_names() %>%
  mutate(species_short=stringr::word(species,1))
ggplot(data=d,mapping=aes(x=flipper_length_mm,y=body_mass_g)) +
  geom_point(pch=21,color="black",fill="lightgrey",size=2) +
  geom_smooth(method="lm",se=FALSE,color="black",size=1) +
  stat_SLR_equation(aes(label=..eq.label..),
                    label.x.npc=0,label.y.npc=1,cf.digits=c(0,1)) +
  stat_SLR_equation(aes(label=..rr.label..),label.x.npc=0,label.y.npc=0.90) +
  labs(x="Flipper Length (mm)",y="Body Mass (g)") +
  theme_NCStats() +
  theme(aspect.ratio=1,plot.title=element_text(size=12)) +
  facet_wrap(~species_short,nrow=1)
```

Use the results for **CHINSTRAP** penguins to answer the questions below.

1. In terms of the variables of this problem, what is the equation of the best-fit line?
1. In terms of the variables of this problem, INTERPRET the value of the slope?
1. In terms of the variables of this problem, INTERPRET the value of the y-intercept?
1. What is the predicted body mass for a flipper length of 200 mm?
1. What is the predicted body mass for a flipper length of 160 mm??
1. What is the residual if the body mass is 3000 g and the flipper length is 190 mm?
1. What is the correlation coefficient between flipper length and body mass?
1. What proportion of the variability in body mass is explained by knowing the flipper length?
1. How much would you expect the body mass to change if the flipper length decreased by 25 mm?
1. What aspect of this regression analysis concerns you (i.e., consider the regression assumptions)?

----

## Footnotes
[^avocdata]: These data are originally from [this kaggle site](https://www.kaggle.com/neuromusic/avocado-prices).
[^PengData]: These data from the Palmer LTER data repository were supported by Office of Polar Programs, NSF Grants OPP-9011927, OPP-9632763 and OPP-0217282. These data were made available by [Allison Horst in this repository](https://github.com/allisonhorst/penguins).
