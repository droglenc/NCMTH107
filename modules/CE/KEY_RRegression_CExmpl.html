---
layout: page
title: "Answer Key"
subtitle: "R Linear Regression Class Example"
author: Derek H. Ogle
css: "/css/modules.css"
---


<hr />
<div id="climate-change-data" class="section level2">
<h2>Climate Change Data</h2>
<p>The slope, intercept, and r<sup>2</sup> values, along with a scatterplot with the best-fit line, needed to perform a linear regression can all be computed with R if the raw data are available as they were here. These results can be used to answer the 12 questions I usually ask in linear regression as demonstrated in the <a href="KEY_LinearRegression_CExmpl">annotations for the linear regression class example</a>.</p>
<p>The data are loaded below. Note the variables we will use here are <code>Temp</code> and <code>CO2</code>.</p>
<pre class="r"><code>&gt; dfobj &lt;- read.csv(&quot;http://derekogle.com/NCMTH107/modules/CE/GSI_data.csv&quot;)
&gt; str(dfobj)</code></pre>
<pre><code>&#39;data.frame&#39;:   32 obs. of  4 variables:
 $ Year           : int  1979 1980 1981 1982 1983 1984 1985 1986 1987 1988 ...
 $ Temp           : int  8 19 26 4 25 9 4 12 27 31 ...
 $ CO2            : num  337 339 340 341 343 ...
 $ SolarIrradiance: num  1366 1367 1367 1366 1366 ...</code></pre>
<pre class="r"><code>&gt; headtail(dfobj)</code></pre>
<pre><code>   Year Temp    CO2 SolarIrradiance
1  1979    8 336.67         1366.43
2  1980   19 338.57         1366.51
3  1981   26 339.92         1366.51
30 2008   44 384.39         1365.27
31 2009   57 386.34         1365.25
32 2010   63 388.13         1365.46</code></pre>
<p>The best-fit line is found in r with <code>lm()</code> which takes a formula of the form <code>qvarResp~qvarExpl</code>, where <code>qvarResp</code> is the quantitative response variable and <code>qvarExpl</code> is the quantitative explanatory variable. Of course, the <code>data=</code> argument is also needed. The results should be saved into an object.</p>
<pre class="r"><code>&gt; ( lm1 &lt;- lm(Temp~CO2,data=dfobj) )</code></pre>
<pre><code>Coefficients:
(Intercept)          CO2  
    -338.25         1.03  </code></pre>
<p>From this it is seen that the intercept is -338.25 and the slope is 1.03.</p>
<p>The r<sup>2</sup> value is extracted from the saved object with <code>rSquared()</code>.</p>
<pre class="r"><code>&gt; rSquared(lm1,digits=2)</code></pre>
<pre><code>[1] 0.74</code></pre>
<p>The best-fit line can be added to a scatterplot with <code>geom_smooth()</code> including <code>method="lm"</code>. A “confidence band” is added to the plot by default, but it can be removed by including <code>se=FALSE</code>.</p>
<pre class="r"><code>&gt; ggplot(data=dfobj,mapping=aes(x=CO2,y=Temp)) +
    geom_point(pch=21,color=&quot;black&quot;,fill=&quot;darkgray&quot;,size=2) +
    labs(x=&quot;CO2 in Atmosphere (ppm)&quot;,y=&quot;Temperature Anomaly (1/100C)&quot;) +
    geom_smooth(method=&quot;lm&quot;,se=FALSE,color=&quot;red&quot;) +
    theme_NCStats()</code></pre>
<pre><code>`geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="KEY_RRegression_CExmpl_files/figure-html/unnamed-chunk-6-1.png" width="336" /></p>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
