---
layout: page
title: Chi-Square Tests
subtitle: R Handout
author: Derek H. Ogle
css: /css/modules.css
---


<hr />
<div id="first-commands" class="section level2">
<h2>First Commands</h2>
<pre class="r"><code>&gt; library(NCStats)</code></pre>
</div>
<div id="chi-square-distribution-calculations" class="section level2">
<h2>Chi-Square Distribution Calculations</h2>
<p>An example of computing the p-value <span class="math">\(\chi^{2}\)</span>=2.67 and df=3.</p>
<pre class="r"><code>&gt; ( distrib(2.67,distrib=&quot;chisq&quot;,df=3,lower.tail=FALSE) )</code></pre>
<p><img src="RHO_files/figure-html/unnamed-chunk-4-1.png" title="" alt="" width="336" /></p>
<pre><code>[1] 0.4453496</code></pre>
<p>An example of computing the p-value if <span class="math">\(\chi^{2}\)</span>=16.82 and df=8.</p>
<pre class="r"><code>&gt; ( distrib(16.82,distrib=&quot;chisq&quot;,df=8,lower.tail=FALSE) )</code></pre>
<p><img src="RHO_files/figure-html/unnamed-chunk-5-1.png" title="" alt="" width="336" /></p>
<pre><code>[1] 0.03203895</code></pre>
</div>
<div id="chi-square-test" class="section level2">
<h2>Chi-Square Test</h2>
<div id="from-summarized-observed-table" class="section level3">
<h3>From Summarized Observed Table</h3>
<p>When <a href="https://en.wikipedia.org/wiki/Chinook_salmon">Chinook Salmon (<em>Oncorhynchus tshawytscha</em>)</a> were first introduced to Lake Superior there was concern that they would compete with native <a href="https://en.wikipedia.org/wiki/Lake_trout">Lake Trout (<em>Salvelinus namaycush</em>)</a> for <a href="https://en.wikipedia.org/wiki/Coregonus_artedi">Cisco (<em>Coregonus artedi</em>)</a>. Preliminarily, fisheries biologists classified the dominant food items (Cisco, <a href="https://en.wikipedia.org/wiki/Rainbow_smelt">Smelt (<em>Osmerus mordax</em></a>) (another type of fish), or <a href="https://en.wikipedia.org/wiki/Mysis_relicta"><em>Mysis</em></a> (an invertebrate)) in the diets of 50 Lake Trout and 40 Chinook Salmon. They found that 32, 10, and 8 Lake Trout diets were dominated by Cisco, Smelt, and <em>Mysis</em>, respectively. Similarly, 18, 18, and 4 Chinook Salmon diets were dominated by Cisco, Smelt, and <em>Mysis</em>, respectively. Test (at the 10% level) if the distribution of dominant food items differs at the 5% level?</p>
<pre class="r"><code>&gt; freq &lt;- c(32,10,8,18,18,4)
&gt; ( obs &lt;- matrix(freq,nrow=2,byrow=TRUE) )</code></pre>
<pre><code>     [,1] [,2] [,3]
[1,]   32   10    8
[2,]   18   18    4</code></pre>
<pre class="r"><code>&gt; rownames(obs) &lt;- c(&quot;Lake Trout&quot;,&quot;Chinook Salmon&quot;)
&gt; colnames(obs) &lt;- c(&quot;Cisco&quot;,&quot;Smelt&quot;,&quot;Mysis&quot;)
&gt; obs</code></pre>
<pre><code>               Cisco Smelt Mysis
Lake Trout        32    10     8
Chinook Salmon    18    18     4</code></pre>
<pre class="r"><code>&gt; chi1 &lt;- chisq.test(obs,correct=FALSE)
&gt; chi1$expected</code></pre>
<pre><code>                  Cisco    Smelt    Mysis
Lake Trout     27.77778 15.55556 6.666667
Chinook Salmon 22.22222 12.44444 5.333333</code></pre>
<pre class="r"><code>&gt; chi1$expected &gt;= 5</code></pre>
<pre><code>               Cisco Smelt Mysis
Lake Trout      TRUE  TRUE  TRUE
Chinook Salmon  TRUE  TRUE  TRUE</code></pre>
<pre class="r"><code>&gt; chi1</code></pre>
<pre><code>Pearson&#39;s Chi-squared test with obs 
X-squared = 6.5083, df = 2, p-value = 0.03861</code></pre>
<pre class="r"><code>&gt; chi1$residuals</code></pre>
<pre><code>                    Cisco     Smelt      Mysis
Lake Trout      0.8011103 -1.408590  0.5163978
Chinook Salmon -0.8956686  1.574852 -0.5773503</code></pre>
<pre class="r"><code>&gt; percTable(obs,margin=1,digits=1)</code></pre>
<pre><code>               Cisco Smelt Mysis Sum
Lake Trout        64    20    16 100
Chinook Salmon    45    45    10 100</code></pre>
<pre class="r"><code>&gt; ( obs2 &lt;- obs[,-2] )</code></pre>
<pre><code>               Cisco Mysis
Lake Trout        32     8
Chinook Salmon    18     4</code></pre>
<pre class="r"><code>&gt; ( chi2 &lt;- chisq.test(obs2,correct=FALSE) )</code></pre>
<pre><code>Warning in chisq.test(obs2, correct = FALSE): Chi-squared approximation may be incorrect</code></pre>
<pre><code>Pearson&#39;s Chi-squared test with obs2 
X-squared = 0.0301, df = 1, p-value = 0.8624</code></pre>
</div>
<div id="from-raw-data" class="section level3">
<h3>From Raw Data</h3>
<p>The <a href="http://www.norc.org/Research/Projects/Pages/general-social-survey.aspx">General Social Survey</a> (GSS) is a nationwide survey that has been administered since 1972 to gather data on contemporary American society in an attempt to monitor and explain trends in attitudes, behaviors, and attributes of American society. One part of that survey asked respondents to state their opinion on how true the following statement was – “<em>All radioactivity is made by humans.</em>” Respondents were also categorized by their highest educational degree. The results from this portion of the GSS is in <a href="https://raw.githubusercontent.com/droglenc/NCData/master/SciTest1.csv">SciTest1.csv</a>. Use these data to determine, at the 5% level, if the distribution of responses to this statement differs among levels of education.</p>
<pre class="r"><code>&gt; setwd(&quot;C:/aaaWork/Web/GitHub/NCMTH107/modules/Chi_Square&quot;)
&gt; ST1 &lt;- read.csv(&quot;SciTest1.csv&quot;)
&gt; str(ST1)</code></pre>
<pre><code>&#39;data.frame&#39;:   2549 obs. of  2 variables:
 $ degree : Factor w/ 5 levels &quot;bach&quot;,&quot;grad&quot;,..: 5 5 5 5 5 5 5 5 5 5 ...
 $ scitest: Factor w/ 4 levels &quot;def.not&quot;,&quot;def.true&quot;,..: 2 2 2 2 2 2 2 2 2 2 ...</code></pre>
<pre class="r"><code>&gt; levels(ST1$degree)</code></pre>
<pre><code>[1] &quot;bach&quot;  &quot;grad&quot;  &quot;hs&quot;    &quot;jc&quot;    &quot;lt.hs&quot;</code></pre>
<pre class="r"><code>&gt; ST1$fdegree &lt;- factor(ST1$degree,levels=c(&quot;lt.hs&quot;,&quot;hs&quot;,&quot;jc&quot;,&quot;bach&quot;,&quot;grad&quot;))
&gt; levels(ST1$scitest)</code></pre>
<pre><code>[1] &quot;def.not&quot;   &quot;def.true&quot;  &quot;prob.not&quot;  &quot;prob.true&quot;</code></pre>
<pre class="r"><code>&gt; ST1$fscitest &lt;- factor(ST1$scitest,levels=c(&quot;def.not&quot;,&quot;prob.not&quot;,&quot;prob.true&quot;,&quot;def.true&quot;))</code></pre>
<pre class="r"><code>&gt; ( freq.tbl &lt;- xtabs(~fdegree+fscitest,data=ST1) )</code></pre>
<pre><code>       fscitest
fdegree def.not prob.not prob.true def.true
  lt.hs      52      112       155       70
  hs        366      451       437      114
  jc         60       44        36        9
  bach      214      135        78       12
  grad      123       57        18        6</code></pre>
<pre class="r"><code>&gt; ST1.chi &lt;- chisq.test(freq.tbl,correct=FALSE)
&gt; ST1.chi$expected</code></pre>
<pre><code>       fscitest
fdegree   def.not  prob.not prob.true  def.true
  lt.hs 124.37623 121.93448 110.48882  32.20047
  hs    437.39506 428.80816 388.55708 113.23970
  jc     47.64025  46.70498  42.32091  12.33386
  bach  140.36289 137.60730 124.69047  36.33935
  grad   65.22558  63.94508  57.94272  16.88662</code></pre>
<pre class="r"><code>&gt; ST1.chi$expected &gt;= 5</code></pre>
<pre><code>       fscitest
fdegree def.not prob.not prob.true def.true
  lt.hs    TRUE     TRUE      TRUE     TRUE
  hs       TRUE     TRUE      TRUE     TRUE
  jc       TRUE     TRUE      TRUE     TRUE
  bach     TRUE     TRUE      TRUE     TRUE
  grad     TRUE     TRUE      TRUE     TRUE</code></pre>
<pre class="r"><code>&gt; all(chi1$expected &gt;= 5)</code></pre>
<pre><code>[1] TRUE</code></pre>
<pre class="r"><code>&gt; ST1.chi</code></pre>
<pre><code>Pearson&#39;s Chi-squared test with freq.tbl 
X-squared = 288.2331, df = 12, p-value &lt; 2.2e-16</code></pre>
<pre class="r"><code>&gt; ST1.chi$residuals</code></pre>
<pre><code>       fscitest
fdegree    def.not   prob.not  prob.true   def.true
  lt.hs -6.4897392 -0.8996675  4.2345762  6.6612431
  hs    -3.4137460  1.0716718  2.4575530  0.0714471
  jc     1.7906992 -0.3958064 -0.9716327 -0.9492868
  bach   6.2154218 -0.2222643 -4.1813025 -4.0375730
  grad   7.1536326 -0.8685073 -5.2473280 -2.6492428</code></pre>
<pre class="r"><code>&gt; percTable(freq.tbl,margin=1,digits=1)</code></pre>
<pre><code>       fscitest
fdegree def.not prob.not prob.true def.true   Sum
  lt.hs    13.4     28.8      39.8     18.0 100.0
  hs       26.8     33.0      31.9      8.3 100.0
  jc       40.3     29.5      24.2      6.0 100.0
  bach     48.7     30.8      17.8      2.7 100.0
  grad     60.3     27.9       8.8      2.9  99.9</code></pre>
</div>
</div>


</div>

<script>

// add bootstrap table styles to pandoc tables
$(document).ready(function () {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
});

</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
