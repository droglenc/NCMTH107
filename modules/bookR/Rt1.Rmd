---
title: "25 - 1-Sample t-Test in R"
description: |
  Methods for computing results for a 1-sample t-test.
output:
  distill::distill_article:
    toc: true
    toc_depth: 2
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo=TRUE,fig.align='center',comment="#R>  ",fig.width=3.5,fig.height=3.5)
```

In the [1-Sample t-test module](../tTest1.html) you learned about the theory underlying a 1-sample t-test and how to perform the calculations required to complete the [11-steps](../11-steps) of a hypothesis test. In this module, you will learn how to perform the required calculations from raw data using R. You will also be asked to complete the full 11-steps for a 1-sample t-test.

Methods in this module require the `NCStats` package (as always) and the `ggplot2` package (for making graphs).

```{r}
library(NCStats)
library(ggplot2)
```

# 1-Sample t-Test in R
If raw data exist, the calculations for a 1-Sample t-test can be efficiently computed with `t.test()`. `t.test()` requires the vector of quantitative data as the first argument, the null hypothesized value for $\mu$ in `mu=`, the type of alternative hypothesis in `alt=` (can be `alt="two.sided"` (the default), `alt="less"`, or `alt="greater"`), and the level of confidence as a proportion in `conf.level=` (defaults to 0.95). If the sample size is less than 40 then you may also need to construct a histogram as described in the [Univariate EDA in R module](RUnivEDA.html) to assess the shape of the distribution.

&nbsp;

# Example - Crab Body Temperature
Below are the [11-steps](../11-steps) for completing a full hypothesis test for the following situation:

> A marine biologist wants to determine if the body temperature of crabs exposed to ambient air temperature is different than the ambient air temperature. The biologist exposed a sample of 25 crabs to an air temperature of 24.3<sup>o</sup>C for several minutes and then measured the body temperature of each crab (shown below). Test the biologist's question at the 5% level.

```
22.9,22.9,23.3,23.5,23.9,23.9,24.0,24.3,24.5,24.6,24.6,24.8,24.8,
25.1,25.4,25.4,25.5,25.5,25.8,26.1,26.2,26.3,27.0,27.3,28.1
```

```{r echo=FALSE}
df <- data.frame(ct=c(22.9,22.9,23.3,23.5,23.9,23.9,24.0,24.3,24.5,
                      24.6,24.6,24.8,24.8,25.1,25.4,25.4,25.5,25.5,
                      25.8,26.1,26.2,26.3,27.0,27.3,28.1))
```
```{r 1tcrabs, echo=FALSE,results='hide',fig.show='hide'}
( ct.t <- t.test(df$ct,mu=24.3,conf.level=0.95) )
```
1. &alpha; = 0.05.
1. H<sub>0</sub>:&mu; = 24.3<sup>o</sup>C vs. H<sub>A</sub>:&mu; &ne; 24.3<sup>o</sup>C, where &mu; is the mean body temperature of ALL crabs.
1. A 1-Sample t-Test is required because (1) a quantitative variable (temperature) was measured, (ii) individuals from one group (or population) were considered (an ill-defined population of crabs), and (iii) &sigma; is **UN**known.
1. The data appear to be part of an experimental study (the temperature was controlled) with no suggestion of random selection of individuals.
1. i. n = 25 &geq; 15 and the sample distribution of crab temperatures appears to be only slightly right-skewed (Figure \@ref(fig:CrabTempHist)) and ii. &sigma; is **UN**known.
1. x&#772; = `r formatC(ct.t$estimate,format="f",digits=1)`<sup>o</sup>C (Table \@ref(tab:1tcrabs)).
1. t = `r formatC(ct.t$statistic,format="f",digits=3)` with `r formatC(ct.t$parameter,format="f",digits=0)` df (Table \@ref(tab:1tcrabs)).
1. p-value = `r kPvalue(ct.t$p.value,include.p=FALSE,latex=FALSE)` (Table \@ref(tab:1tcrabs)).
1. Reject H<sub>0</sub> because the p-value &alpha;.
1. It appears that the average body temperature of ALL crabs is greater than the ambient temperature of 24.3<sup>o</sup>C.
1. I am 95% confident that the mean body temperature of ALL crabs is between `r formatC(ct.t$conf.int[1],format="f",digits=1)`<sup>o</sup>C and `r formatC(ct.t$conf.int[2],format="f",digits=1)`<sup>o</sup>C (Table \@ref(tab:1tcrabs)).

```{r CrabTempHist, echo=FALSE, fig.cap="Histogram of the body temperatures of crabs exposed to an ambient temperature of $24.3^{o}$C."}
ggplot(data=df,mapping=aes(x=ct)) +
  geom_histogram(boundary=0,binwidth=1,color="black",fill="darkgray") +
  labs(y="Frequency of Crabs",x="Body Temperature (C)") +
  scale_y_continuous(expand=expansion(mult=c(0,0.05))) +
  theme_NCStats()
```

```{r echo=FALSE, background='white',warning=FALSE}
knitr::kable(capture.output(kHtest(ct.t)),col.names=NULL,label="1tcrabs",caption="Results from 1-Sample t-Test for body temperature of crabs.")
```

**R Appendix:**
```{r eval=FALSE}
setwd("c:/data")
df <- read.csv("CrabTemps.csv")
<<CrabTempHist>>
<<1tcrabs>>
```


# Corrections {.appendix}
If you see any errors (code, typographical, or logical) please bring these to [my attention](mailto:dogle@northland.edu).
