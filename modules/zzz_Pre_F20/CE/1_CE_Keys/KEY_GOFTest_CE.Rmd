---
title: "Answer Key"
subtitle: "Goodness-of-Fit CE"
author: Derek H. Ogle
layout: page
css: "/css/modules.css"
output:
  html_document:
    self_contained: false
---

```{r echo=FALSE, eval=FALSE}
## Renders an appropriate HTML file and moves to CE directory
source("modules/CE/1_CE_Keys/zzz_modHTML_CEKeys.R")
modHTML_CEKeys("KEY_GOFTest_CE")
```

```{r echo=FALSE, results='hide', message=FALSE}
library(NCStats)
source("../../../rhelpers/knitr_setup.R")
library(captioner)
tbls <- captioner(prefix="Table")

tbls(name="WaterExpTable","Expected frequency of students (assuming that Ho is true) by water type choice.")
tbls(name="WaterObsTable","Observed frequency of students by water type choice.")
tbls(name="WaterResults","Goodness-of-fit test results for testing that the distribution of students was the same among water type choices.")
tbls(name="WaterSum","Summary table of the proportion of students in each water type choice, with 99% confidence intervals and expected proportions from the goodness-of-fit test.")

tbls(name="TurkeyExpTable","Expected frequency of turkeys (assuming that Ho is true) by habitat in the spring.")
tbls(name="TurkeyObsTable","Observed frequency of turkeys by habitat in the spring.")
tbls(name="TurkeyResults","Goodness-of-fit test results for testing that the distribution of turkeys in the spring is the same as the disribution of available habitats.")
tbls(name="TurkeySum","Summary table of the proportion of turkeys in each habitat type, with 95% confidence intervals and expected proportions from the goodness-of-fit test.")

tbls(name="JuryExpTable","Expected frequency of jurors (assuming that Ho is true) by age category.")
tbls(name="JuryObsTable","Observed frequency of jurors by age category.")
tbls(name="JuryResults","Goodness-of-fit test results for testing that the distribution of jurors by age category matched the distribution in the district as a whole.")
tbls(name="JurySum","Summary table of the proportion of jurors in each habitat type, with 95% confidence intervals and expected proportions from the goodness-of-fit test.")

tbls(name="bear","Observed and expected frequencies for habitat use by a bear.")
tbls(name="ginseng","Observed and expected frequencies for browsing by deer on ginseng plants.")
tbls(name="ginseng2","Results from the goodness-of-fit test for testing that more than one-third of ginseng plants were browsed by deer.")
tbls(name="roadrage","Observed frequencies of road rage by day of the week.")
tbls(name="roadrage2","Results from the goodness-of-fit test for testing that the frequencies of road rage differed among days of the week.")
tbls(name="roadrage3","Confidence intervals (95%) for the proportion of observations of road rage by day of the week.")
```

----

## Preference for Bottled Water?

```{r WaterCalc, echo=FALSE, results='hide', fig.show='hide', warning=FALSE}
w.obs <- c(tap=51,Aquafina=18,Fiji=17,Sams=21)
w.exp <- c(tap=1,Aquafina=1,Fiji=1,Sams=1)/4
w.chi <- chisq.test(w.obs,p=w.exp,rescale.p=TRUE,correct=FALSE)
w.chi
gofCI(w.chi,digits=3,conf.level=0.99)
```

<ol>
<li>&alpha;=0.01.</li>
<li>H<sub>A</sub>: "There is a preference among the water choices (i.e., the distribution of students will NOT follow a theoretical distribution of equal proportions among the water choices)" and H<sub>0</sub>: "There is no preference among the water choices (i.e., the distribution of students will follow a theoretical distribution of equal proportions among the water choices)".</li>
<li>Goodness-of-fit test because (i) one group or population (students) were sampled and (ii) the response variable (water choice) is categorial.</li>
<li>This is quasi-experimental as the students were given a choice of only certain waters. The students were not obviously randomly selected (and were likely part of a voluntary response survey).</li>
<li>All cells in the expected frequency table (`r tbls("WaterExpTable",display="cite")`) were greater than 5; the assumptions for a goodness-of-fit test have been met.</li>

`r tbls("WaterExpTable")`

```{r echo=FALSE}
w.chi$expected
```

<li>The observed frequency table is shown in `r tbls("WaterObsTable",display="cite")`.</li>

`r tbls("WaterObsTable")`

```{r echo=FALSE}
w.chi$observed
```

<li>&chi;<sup>2</sup>=`r formatC(w.chi$statistic,format="f",digits=4)` with `r w.chi$parameter` df (`r tbls("WaterResults",display="cite")`).</li>

`r tbls("WaterResults")`

```{r echo=FALSE}
w.chi
```

<li>p-value`r kPvalue(w.chi$p.value,include.p=FALSE,latex=FALSE)` (`r tbls("WaterResults",display="cite")`).</li>
<li>Reject H<sub>0</sub> because the p-value&lt;&alpha;.</li>
<li>It appears that there is a preference for water type by the students. Further analysis (`r tbls("WaterSum",display="cite")`) suggests that the students preferred the tap water.</li>

`r tbls("WaterSum")`

```{r echo=FALSE}
gofCI(w.chi,digits=3,conf.level=0.99)
```

<li>From `r tbls("WaterSum",display="cite")`, one can conclude that between `r formatC(gofCI(w.chi,conf.level=0.99)["tap","p.LCI"]*100,format="f",digits=1)` and  `r formatC(gofCI(w.chi,conf.level=0.99)["tap","p.UCI"]*100,format="f",digits=1)`% of the students chose the tapwater.</li>
</ol>

R Appendix.
```{r eval=FALSE, prompt=FALSE}
<<WaterCalc>>
```

----

## Habitat Use by Wild Turkeys

```{r TurkeyCalc, echo=FALSE, results='hide', fig.show='hide', warning=FALSE}
t.obs <- c(Aspen=61,Meadow=9,Pine=807,OakSpruce=1)
t.exp <- c(Aspen=0.0516,Meadow=0.1016,Pine=0.8371,OakSpruce=0.0100)
t.chi <- chisq.test(t.obs,p=t.exp,rescale.p=TRUE,correct=FALSE)
t.chi
gofCI(t.chi,digits=3)
```

<ol>
<li>&alpha;=0.05.</li>
<li>H<sub>A</sub>: "There is a preference by the turkeys for habitat (i.e., the distribution of turkeys will NOT follow the distribution of available habitats)" and H<sub>0</sub>: "There is NOT a preference by the turkeys for habitat (i.e., the distribution of turkeys will follow the distribution of available habitats)".</li>
<li>Goodness-of-fit test because (i) one group or population (South Dakota turkeys) were sampled and (ii) the response variable (habitat use) is categorical.</li>
<li>This is observational as habitat use by the turkeys was simply recorded. The turkey observations were not randomly selected (the researchers likely chose days to sample).</li>
<li>All cells in the expected frequency table (`r tbls("TurkeyExpTable",display="cite")`) were greater than 5; the assumptions for a goodness-of-fit test have been met.</li>

`r tbls("TurkeyExpTable")`

```{r echo=FALSE}
t.chi$expected
```

<li>The observed frequency table is shown in `r tbls("TurkeyObsTable",display="cite")`.</li>

`r tbls("TurkeyObsTable")`

```{r echo=FALSE}
t.chi$observed
```

<li>&chi;<sup>2</sup>=`r formatC(t.chi$statistic,format="f",digits=4)` with `r t.chi$parameter` df (`r tbls("TurkeyResults",display="cite")`).</li>

`r tbls("TurkeyResults")`

```{r echo=FALSE}
t.chi
```

<li>p-value`r kPvalue(t.chi$p.value,include.p=FALSE,latex=FALSE)` (`r tbls("TurkeyResults",display="cite")`).</li>
<li>Reject H<sub>0</sub> because the p-value&lt;&alpha;.</li>
<li>It appears that the turkeys show a habitat preference in the spring. Further analysis (`r tbls("TurkeySum",display="cite")`) suggests that the turkeys showed a strong avoidance of meadows, a moderate avoidance of Oak/Spruce habitats, and a moderate preference for aspen and pine habitats.</li>

`r tbls("TurkeySum")`

```{r echo=FALSE}
gofCI(t.chi,digits=3)
```

<li>From `r tbls("TurkeySum",display="cite")`, one can conclude that between `r formatC(gofCI(t.chi)["Pine","p.LCI"]*100,format="f",digits=1)` and `r formatC(gofCI(t.chi)["Pine","p.UCI"]*100,format="f",digits=1)`% of the turkey observations were in the pine habitat.</li>
</ol>

R Appendix.
```{r eval=FALSE, prompt=FALSE}
<<TurkeyCalc>>
```

----

## Random Jury Pool

```{r JuryCalc, echo=FALSE, results='hide', fig.show='hide', warning=FALSE}
j.obs <- c("18-19"=23,"20-24"=96,"25-29"=134,"30-39"=293,
           "40-49"=297,"50-64"=380,"65+"=113)
j.exp <- c("18-19"=6.1,"20-24"=15.0,"25-29"=13.5,"30-39"=21.7,
           "40-49"=15.3,"50-64"=18.2,"65+"=10.2)
j.chi <- chisq.test(j.obs,p=j.exp,rescale.p=TRUE,correct=FALSE)
j.chi
gofCI(j.chi,digits=3)
```

<ol>
<li>&alpha;=0.10.</li>
<li>H<sub>A</sub>: "The age distribution of the actual jury is not the same as the age distribution in the district as a whole" and H<sub>0</sub>: "The age distribution of the actual jury is the same as the age distribution in the district as a whole".</li>
<li>Goodness-of-fit test because (i) one group or population (the jury in this district) were sampled and (ii) the response variable (age category) is categorial.</li>
<li>This is observational as the jurors were not allocated to ages. In theory the jury was randomly selected from the district, but that is what is being tested.</li>
<li>All cells in the expected frequency table (`r tbls("JuryExpTable",display="cite")`) were greater than 5; the assumptions for a goodness-of-fit test have been met.</li>

`r tbls("JuryExpTable")`

```{r echo=FALSE}
j.chi$expected
```

<li>The observed frequency table is shown in `r tbls("JuryObsTable",display="cite")`.</li>

`r tbls("JuryObsTable")`

```{r echo=FALSE}
j.chi$observed
```

<li>&chi;<sup>2</sup>=`r formatC(j.chi$statistic,format="f",digits=4)` with `r j.chi$parameter` df (`r tbls("JuryResults",display="cite")`).</li>

`r tbls("JuryResults")`

```{r echo=FALSE}
j.chi
```

<li>p-value`r kPvalue(j.chi$p.value,include.p=FALSE,latex=FALSE)` (`r tbls("JuryResults",display="cite")`).</li>
<li>Reject H<sub>0</sub> because the p-value&lt;&alpha;.</li>
<li>It appears that the age distribution of the jury does not match the age distribution of the district as a whole. Further analysis (`r tbls("JurySum",display="cite")`) suggests that the jury has a higher percentage of older jurors (ages "40-49" and "50-64") and a lower percentage of younger jurors (ages "18-19", "20-24", and "25-29") than expected as based on the age distribution in the district as a whole.</li>

`r tbls("JurySum")`

```{r echo=FALSE}
gofCI(j.chi,digits=3)
```

<li>From `r tbls("JurySum",display="cite")`, one can conclude, for example, that between `r formatC(gofCI(j.chi)["18-19","p.LCI"]*100,format="f",digits=1)` and `r formatC(gofCI(j.chi)["18-19","p.UCI"]*100,format="f",digits=1)`% of the jurors were between 18-19 years old.</li>
</ol>

R Appendix.
```{r eval=FALSE, prompt=FALSE}
<<JuryCalc>>
```

----

## Bear Habitat Use
<ol>
  <li>&alpha; =0.10.</li>
  <li>H<sub>0</sub>:"The proportion of habitats used by the bear is the same as the proportions of available habitat" versus H<sub>A</sub>:"The proportion of habitats used by the bear is the same as the proportions of available habitat."</li>
  <li>A goodness-of-fit test is required because a single categorical variable (habitat use) from a single group or population (this bear) was measured and the proportions are being compared to a theoretical distribution in the null hypothesis.</li>
  <li>This is an observational study with randomly selected times for observation.</li>
  <li>The expected number of observations in each habitat is in proportion to the GIS analysis of habitat availability. Thus, the expected number in each habitat is shown in `r tbls("bear",display="cite")` (along with the observed frequencies). Note that these percentages did not need to be adjusted to the number of observations because 100 observations were made. The test statistic computed below should reasonably follow a chi-square distribution because all of the expected values are greater than five.</li>
  
`r tbls("bear")`

Habitat | Obs Freq | Exp Freq
------- | -------- | --------
Lowland Conifer  | 47 | 34
Aspen            | 12 | 17
Open Areas       | 10 | 12
Upland Hardwoods | 21 | 25
Mixed Upland     | 10 | 12
<br>
  
  <li>The table of observed frequencies is shown in `r tbls("bear",display="cite")`.</li>
  <li>The &chi;<sup>2</sup> test statistic is $\frac{(47-34)^{2}}{34}$ + $\frac{(12-17)^{2}}{17}$ + $\frac{(10-12)^{2}}{12}$ + $\frac{(21-25)^{2}}{25}$  + $\frac{(10-12)^{2}}{12}$ = 4.971 + 1.471 + 0.333 + 0.640 + 0.333 = 7.7478 with 5-1=4 df.</li>
  <li>The p-value is `r kPvalue(distrib(7.7478,distrib="chisq",df=4,lower.tail=FALSE,plot=FALSE),include.p=FALSE,latex=FALSE)`.</li>
  <li>The H<sub>0</sub> is not rejected because the p-value>&alpha;.</li>
  <li>The bear appears to use the habitats in proportion to the availability of the habitat.</li>
</ol>

R Appendix.
```{r eval=FALSE, prompt=FALSE}
library(NCStats)
( distrib(7.7478,distrib="chisq",df=4,lower.tail=FALSE) )
```


## Ginseng Consumption by Deer
```{r GINCalc,echo=FALSE, results='hide'}
obs <- c(consumed=33,not.consumed=40)
exp <- c(consumed=0.33,not.consumed=1-0.33)
( gin.chi <- chisq.test(obs,p=exp,correct=FALSE) )
( gin.p <- gofCI(gin.chi) )
```

<ol>
  <li>&alpha; =0.05.</li>
  <li>H<sub>0</sub>:"The proportion of ginseng plants consumed by deer is 0.33" versus H<sub>A</sub>:"The proportion of ginseng plants consumed by deer is NOT 0.33".</li>
  <li>A goodness-of-fit test is required because a categorical variable (consumed or not) from a single group or population was recorded and the frequency of responses is being compared to a theoretical distribution in the null hypothesis.</li>
  <li>An observational study with randomly selected plants was used.</li>
  <li>The expected number of consumed plants is 73&times;0.33=`r formatC(gin.chi$expected[1],format="f",digits=2)`. The expected number of plants not consumed by deer is 73&times;(1-0.33)=`r formatC(gin.chi$expected[2],format="f",digits=2)`. the test statistic computed below should reasonably follow a chi-square distribution because both of these expected values is greater than five.</li>
  <li>The table of observed frequencies is in `r tbls("ginseng",display="cite")` (along with the expected frequencies from the previous step).</li>

`r tbls("ginseng")`

Habitat | Obs Freq | Exp Freq
------- | -------- | --------
Yes | 33 | `r formatC(gin.chi$expected[1],format="f",digits=2)`
No  | 40 | `r formatC(gin.chi$expected[2],format="f",digits=2)`
<br>

  <li>The &chi;<sup>2</sup> test statistic is `r formatC(gin.chi$statistic,format="f",digits=3)` with `r formatC(gin.chi$parameter,format="f",digits=0)` df (`r tbls("ginseng2",display="cite")`).</li>

`r tbls("ginseng2")`

```{r echo=FALSE,background="white"}
kHtest(gin.chi)
```

  <li>The p-value is `r kPvalue(gin.chi$p.value,include.p=FALSE,latex=FALSE)` (`r tbls("ginseng2",display="cite")`).</li>
  <li>The H<sub>0</sub> is rejected because the p-value<&alpha;.</li>
  <li>It appears that more than 33% of the ginseng plants at this site and year were consumed by deer.</li>
  <li>One is 95% confident that the proportion of ginseng plants consumed by deer is between `r formatC(gin.p["consumed","p.LCI"],format="f",digits=3)` and `r formatC(gin.p["consumed","p.UCI"],format="f",digits=3)`.</li>
</ol>

R Appendix.
```{r eval=FALSE, prompt=FALSE}
library(NCStats)
<<GINCalc>>
```

## Road Rage
```{r echo=FALSE}
rr <- read.csv("https://raw.githubusercontent.com/droglenc/NCData/master/RoadRage.csv")
```
```{r RRCalc, echo=FALSE, results='hide'}
rr$Day1 <- factor(rr$Day,levels=c("M","Tu","W","Th","F","Sa","Su"))
obs <- table(rr$Day1)
exp <- rep(69/7,7)
( rr.chi <- chisq.test(obs,p=exp,correct=FALSE,rescale=TRUE) )
( rr.ci <- gofCI(rr.chi) )
```

<ol>
  <li>&alpha; =0.05.</li>
  <li>H<sub>0</sub>:"The proportion of road rage incidents is the same on each day of the week" versus H<sub>A</sub>:"The proportion of road rage incidents is NOT the same on each day of the week".</li>
  <li>A goodness-of-fit test is required because a categorical response variable with seven levels (days of the week) from a single group or population was recorded and the frequency of responses is being compared to a theoretical distribution in the null hypothesis.</li>
  <li>This is an observational study without obvious randomization.</li>
  <li> The expected number of road rage incidents on each day is $\frac{69}{7}$ = `r formatC(69/7,format="f",digits=1)` which are all greater than five. Thus, the test statistic computed below should reasonably follow a chi-square distribution.</li>
  <li>The table of observed frequencies is shown in `r tbls("roadrage",display="cite")`.</li>
  
`r tbls("roadrage")`

```{r echo=FALSE,background="white"}
obs
```

  <li>The &chi;<sup>2</sup> test statistic is `r formatC(rr.chi$statistic,format="f",digits=3)` with `r formatC(rr.chi$parameter,format="f",digits=0)` df (`r tbls("roadrage2",display="cite")`).</li>
  
`r tbls("roadrage2")`

```{r echo=FALSE,background="white"}
kHtest(rr.chi)
```

  <li>The p-value is `r kPvalue(rr.chi$p.value,include.p=FALSE,latex=FALSE)` (`r tbls("roadrage2",display="cite")`).</li>
  <li>The H<sub>0</sub> is rejected because the p-value<&alpha;.</li>
  <li>It appears that the proportion of incidences of road rage differs among the days of the week.</li>
  <li>An examination of the confidence interval results (`r tbls("roadrage3",display="cite")`) suggests that there are more incidences of road rage on Fridays and possibly fewer on Mondays than would be expected.</li>

`r tbls("roadrage3")`

```{r RRCI, echo=FALSE,background="white"}
round(rr.ci,2)
```
</ol>

R Appendix.
```{r eval=FALSE, prompt=FALSE}
library(NCStats)
setwd('C:/aaaWork/Books/IntroStats/HW/')
rr <- read.csv("RoadRage.csv")
<<RRCalc>>
<<RRCI>>
```
