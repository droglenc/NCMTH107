---
layout: page
title: Modules
author: "Derek H. Ogle"
css: "/css/syllabus.css"
output:
  html_document:
    self_contained: false
    lib_dir: zlibs
---

```{r echo=FALSE, eval=FALSE}
# Renders an appropriate HTML file for the webpage
setwd("C:/aaaWork/Web/GitHub/NCMTH107/resources/")
source("../rhelpers/rhelpers.R")
modHTML("Dates-Current")
```

<div class="alert alert-info">
Past dates/modules are shown at the bottom of the page.
</div>

```{r echo=FALSE, warning=FALSE, message=FALSE}
sn <- "W22"
library(dplyr)
options(knitr.kable.NA = '')
## Read dates, make date with day and topic with link
d <- readxl::read_excel("Dates_107.xlsx",sheet=sn) %>%
  dplyr::mutate(Date=as.Date(Date)) %>%
  dplyr::mutate(Date2=paste0(DOW,", ",format(Date,"%b-%d")),
                Topic=ifelse(is.na(url),Topic,
                       paste0('<a href=\"../modules/',url,'\">',Topic,'</a>'))) %>%
  dplyr::select(Date,Date2,Topic)
```

```{r echo=FALSE, warning=FALSE, message=FALSE}
## Get only future dates
dfuture <- d %>%
  dplyr::filter(Date>=lubridate::today()) %>%
  select(-Date) %>%
  rename(Date=Date2)

## Only continue if there are future dates
if (nrow(dfuture)>0) {
  ## Put a blank row after each Friday
  blank_rows <- grep("F",dfuture$Date)
  if (blank_rows[length(blank_rows)]==nrow(dfuture))
    blank_rows <- blank_rows[-length(blank_rows)]
  for (i in rev(blank_rows))
    dfuture <- dplyr::add_row(dfuture,Date=NA,Topic=NA_character_,.after=i)

  ## Make the kable
  knitr::kable(dfuture,format="html",escape=FALSE) %>%
    kableExtra::kable_styling(bootstrap_options=c("condensed","hover","responsive"),
                              full_width=FALSE,position="center",
                              fixed_thead=TRUE)
}
```

<br>

<br>

# Completed

```{r echo=FALSE, warning=FALSE, message=FALSE}
## Get only past dates
dpast <- d %>%
  dplyr::filter(Date<lubridate::today()) %>%
  select(-Date) %>%
  rename(Date=Date2)

## Only continue if there are past dates
if (nrow(dpast)>0) {
  ## Make the kable
  knitr::kable(dpast,format="html",escape=FALSE) %>%
    kableExtra::kable_styling(bootstrap_options=c("condensed","hover","responsive"),
                              full_width=FALSE,position="center",
                              fixed_thead=TRUE)
}
```
